[["index.html", "Diari de les Classes de Mètodes Estadístics Aplicats (21703). Curs 2021-2022 Introducció", " Diari de les Classes de Mètodes Estadístics Aplicats (21703). Curs 2021-2022 Ferran Carrascosa Mallafrè 2022-01-12 Introducció Aquesta web té com a objectiu donar suport als continguts de les clases de teoría y seminaris del curs 2021-2022 de Mètodes Estadístics Aplicats (21703). Els continguts de la web sestructuren de la següent forma: Diari dapunts de clase de teoria Diari dapunts dels seminaris Deures del curs "],["teoria-setmana-1.html", "Capítol 1 Teoria Setmana 1 1.1 Avaluació 1.2 Bibliografia 1.3 Introducció conceptes Estadística 1.4 Gender gap, at birth 1.5 With Arbuthnotts data, collected on years 1629 to 1710 1.6 Distribució duna variable, distribució normal, altres distribucions", " Capítol 1 Teoria Setmana 1 Discussió sobre: Logística del curs: Teoria i seminaris: Horaris Canals: Aula global, Web de curs El PDA Avaluació: Participació seminaris (15%), Treball (35%), Examen Final (50%) Disseny del curs: Conceptes, dades, programari Eina de treball: R 1.1 Avaluació 1.1.1 El treball Consulta la Guía del Treball de fi de curs. Consulta a lAula global els Exemples de treballs danys anteriors. 1.1.2 Exàmens Consulta a lAula global els Exàmens danys anteriors. 1.1.3 Participació A laula dinformàtica es resoldran deures a classe. A la secció de la Llista de deures 3, es publicaràn fins a 3 problemes que shauràn dentregar de forma individual i es resoldrà a classe. 1.2 Bibliografia Mètodes aplicats a Ciències polítiques AnalizaR Datos Políticos. Bookdown. 2020. Quantitative Politics with R. Bookdown. November 2019. Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration. Bookdown Quantitative Research Methods for Political Science, Public Policy and Public Administration: 4th Edition With Applications in R. Bookdown General R y Estadística R Markdown: The Definitive Guide. Chapman &amp; Hall/CRC; 2020. R Graphics Cookbook, OReilly Media, Inc. 2nd ed.; 2020. Data Visualization with R. 2018. R for Data Science. OReilly; 2017. (Castellano) An Introduction to Statistical Learning with applications in R. Springer; 2017. 1.3 Introducció conceptes Estadística Introducció a lassignatura. Llibres, la nostra calculadora de butxaca. Interacció entre Teoria (preguntes), Dades, Estadística (conceptes, no fórmules). Un exemple, per començar a rodar. 1.4 Gender gap, at birth Question: Is there a gender birth rate?. At birth, probability of a boy equal to the probability of a girl? What CIA says on this issue? (Wikipedia) CIA estimates that the current world wide sex ratio at birth is 107 boys to 100 girls, 107/207= 0.5169082 1.5 With Arbuthnotts data, collected on years 1629 to 1710 John Graunt was the first person to compile data that showed an excess of male births over female births. He also noticed spatial and temporal variation in the sex ratio, but the variation in his data is not significant. John Arbuthnott was the first person to demonstrate that the excess of male births is statistically significant. John Arbuthnot (1710) used these time series data on the ratios of male to female christenings in London from 1629-1710 to carry out the first known significance test, comparing observed data to a null hypothesis. Arbuthnot, J. 1710. An argument for divine providence. Philosophical Transactions 27:186-190. dat&lt;- read.table(&quot;http://84.89.132.1/~satorra/dades/arbuthnot.txt&quot;, header=TRUE) head(dat) ## year boys girls ## 1 1629 5218 4683 ## 2 1630 4858 4457 ## 3 1631 4422 4102 ## 4 1632 4994 4590 ## 5 1633 5158 4839 ## 6 1634 5035 4820 dim(dat) ## [1] 82 3 names(dat) ## [1] &quot;year&quot; &quot;boys&quot; &quot;girls&quot; attach(dat) ## The following objects are masked from dat (pos = 5): ## ## boys, girls, year ## The following objects are masked from dat (pos = 8): ## ## boys, girls, year ## The following objects are masked from dat (pos = 13): ## ## boys, girls, year mean(boys) ## [1] 5907.098 mean(girls) ## [1] 5534.646 mean(boys/girls) ## [1] 1.070748 total&lt;- boys+girls plot(year,total, col=&quot;blue&quot;, main=&quot;total birth along the years&quot;) mean(boys/(boys+girls)) ## [1] 0.5169751 require(stats) # for lowess, rpois, rnorm lines(year,lowess(total,f=1/6)$y, lty=3, lwd=4) boxplot(boys, girls, names=c(&quot;boys&quot;,&quot;girls&quot;), col=c(&quot;blue&quot;,&quot;magenta&quot;)) boysrate&lt;- boys/(boys+girls) plot(year, boysrate, ylim = c(.49,.53), col=&quot;blue&quot;) abline(h=0.5, col=&quot;red&quot;, lwd=3, lty=3) t&lt;- (mean(boysrate) - 0.5)/(sd(boysrate)/sqrt(length(boysrate))) t ## [1] 21.29243 t.test(boysrate, mu=0.5) ## ## One Sample t-test ## ## data: boysrate ## t = 21.292, df = 81, p-value &lt; 2.2e-16 ## alternative hypothesis: true mean is not equal to 0.5 ## 95 percent confidence interval: ## 0.5153889 0.5185614 ## sample estimates: ## mean of x ## 0.5169751 plot(year, boysrate, ylim = c(.49,.53), col=&quot;blue&quot;, main=&quot;Boysrate values with 95% confidence bound (green lines) &quot;) abline(h=0.5, col=&quot;red&quot;, lwd=3, lty=3) # Intervals abline(h=mean(boysrate), col=&quot;blue&quot;, lwd=.8) lines(year, rep(0.5153889, length(year)) , lty = &#39;dashed&#39;, col = &#39;green&#39;, lwd=3) lines(year, rep(0.5186, length(year)) , lty = &#39;dashed&#39;, col = &#39;green&#39;, lwd=3) # add fill n&lt;- length(year) polygon(c(rev(year), year), c( rev(rep(0.5153889, n )), rep(0.5186, n )), border = NA) 1.5.1 Now with recent USAs data, present day birth records in the United States source(&quot;http://www.openintro.org/stat/data/present.R&quot;) head(present) ## year boys girls ## 1 1940 1211684 1148715 ## 2 1941 1289734 1223693 ## 3 1942 1444365 1364631 ## 4 1943 1508959 1427901 ## 5 1944 1435301 1359499 ## 6 1945 1404587 1330869 dim(present) ## [1] 63 3 mean(present$boys/(present$boys+present$girls)) ## [1] 0.512516 boysrate&lt;- present$boys/(present$boys+present$girls) t.test(boysrate, mu=0.5) ## ## One Sample t-test ## ## data: boysrate ## t = 147, df = 62, p-value &lt; 2.2e-16 ## alternative hypothesis: true mean is not equal to 0.5 ## 95 percent confidence interval: ## 0.5123458 0.5126862 ## sample estimates: ## mean of x ## 0.512516 1.6 Distribució duna variable, distribució normal, altres distribucions Distribució duna variable quantitativa (variable numérica): anàlisi de variància. library(foreign) data= read.spss( &quot;http://84.89.132.1/~satorra/dades/PAISOS.SAV&quot;, use.value.labels = TRUE, to.data.frame = TRUE ) attach(data) ## The following objects are masked from data (pos = 5): ## ## AGRICULT, ALFAB, CALORIES, CONT, DIARIS, ESPVIDA, HABMETG, IDH, INDUST, NIVELL, PAIS, ## PIB, SANITAT, TV ## The following objects are masked from data (pos = 8): ## ## AGRICULT, ALFAB, CALORIES, CONT, DIARIS, ESPVIDA, HABMETG, IDH, INDUST, NIVELL, PAIS, ## PIB, SANITAT, TV ## The following objects are masked from data (pos = 12): ## ## AGRICULT, ALFAB, CALORIES, CONT, DIARIS, ESPVIDA, HABMETG, IDH, INDUST, NIVELL, PAIS, ## PIB, SANITAT, TV names(data) ## [1] &quot;IDH&quot; &quot;NIVELL&quot; &quot;PAIS&quot; &quot;ESPVIDA&quot; &quot;PIB&quot; &quot;ALFAB&quot; &quot;CONT&quot; &quot;CALORIES&quot; &quot;HABMETG&quot; ## [10] &quot;DIARIS&quot; &quot;TV&quot; &quot;SANITAT&quot; &quot;AGRICULT&quot; &quot;INDUST&quot; ESPVIDA ## [1] 46.4 52.1 47.5 39.0 50.7 53.5 44.9 50.2 55.6 43.5 47.5 56.5 45.6 47.3 51.0 46.5 60.4 46.0 47.4 ## [20] 65.2 50.4 55.7 48.0 66.7 48.9 45.0 65.5 55.0 47.6 49.4 61.5 56.0 68.5 44.5 56.0 51.5 71.9 67.7 ## [39] 53.7 60.5 63.6 51.0 62.7 62.1 70.4 59.4 49.3 66.3 56.0 64.7 67.6 55.8 64.8 63.3 69.6 57.5 68.8 ## [58] 51.3 67.9 69.9 66.4 65.2 70.3 69.3 66.0 73.6 71.2 70.0 58.8 67.8 69.0 67.1 71.1 76.3 66.5 70.9 ## [77] 70.0 71.5 67.5 71.5 73.6 64.9 72.8 76.0 71.3 73.8 70.2 66.3 67.6 62.9 70.8 70.5 71.7 69.0 72.5 ## [96] 70.8 71.6 67.5 53.5 70.0 72.0 72.1 75.6 69.6 71.1 77.6 74.6 69.7 71.6 77.0 73.1 75.5 75.3 76.5 ## [115] 77.6 78.6 70.5 74.8 77.6 76.2 74.9 77.5 77.4 77.4 76.4 76.9 73.8 75.7 76.2 76.0 76.0 78.2 76.9 ## [134] 75.3 78.2 79.5 75.7 78.0 72.0 76.1 68.5 66.0 63.1 67.1 75.3 63.7 71.1 43.5 50.2 65.2 56.6 57.6 ## [153] 52.0 53.0 46.5 51.6 55.4 47.0 74.2 48.3 summary(ESPVIDA) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 39.00 55.67 67.60 64.50 72.58 79.50 hist(ESPVIDA, col=&quot;blue&quot;) boxplot(ESPVIDA, col=&quot;blue&quot;) 1.6.1 Valor estandarditzat duna variable # variable centrads head(ESPVIDA - mean(ESPVIDA)) ## [1] -18.10437 -12.40437 -17.00437 -25.50437 -13.80437 -11.00437 # variable estandarditzada head((ESPVIDA - mean(ESPVIDA))/sd(ESPVIDA)) ## [1] -1.715521 -1.175405 -1.611288 -2.416725 -1.308065 -1.042744 # Amb R head(scale(ESPVIDA)) ## [,1] ## [1,] -1.715521 ## [2,] -1.175405 ## [3,] -1.611288 ## [4,] -2.416725 ## [5,] -1.308065 ## [6,] -1.042744 1.6.2 Distribució Normal We now investigate the probability distribution that is most central to statistics: the normal distribution. If we are confident that our data are nearly normal, that opens the door to many powerful statistical methods. Here well describe this distribution and assess the normality of our data. Bitllet de 10 marcs: Carl Friedrich Gauss (1777 - Gotinga;1855) 1.6.2.1 Distribució de notes destudiants Veure exemple enllaç. 1.6.3 Exemple amb la variable diners en butxaca (estudiants de MQ III) Dades_enq_paper (diners en butxaca, genere): datadiners&lt;-read.table(&quot;http://84.89.132.1/~satorra/dades/ECP2019diners.txt&quot;, header=TRUE) names(datadiners) ## [1] &quot;diners&quot; &quot;genere&quot; attach(datadiners) ## The following objects are masked from datadiners (pos = 5): ## ## diners, genere ## The following objects are masked from datadiners (pos = 8): ## ## diners, genere ## The following objects are masked from datadiners (pos = 12): ## ## diners, genere summary(diners) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.000 1.000 7.995 16.249 21.625 100.000 boxplot(diners) hist(diners) boxplot(diners ~ genere, col=c(&quot;blue&quot;,&quot;violet&quot;)) aggregate(diners, list(genere), mean) ## Group.1 x ## 1 0 18.30667 ## 2 1 13.30833 Diners en butxaca: distribució normal? qqnorm(datadiners$diners) qqline(datadiners$diners ,col=&quot;red&quot;, lwd=3) 1.6.3.1 Log de diners en butxaca: distribució normal? qqnorm(log(datadiners$diners+ .1)) qqline(log(datadiners$diners +.1),col=&quot;red&quot;, lwd=3) 1.6.3.2 log de diners en butxaca (no zero): distribució normal? ind&lt;- datadiners$diners &gt; 0 qqnorm(log(datadiners$diners[ind])) qqline(log(datadiners$diners[ind]),col=&quot;red&quot;, lwd=3) 1.6.4 Altres distribucions univariants Distribucions univariants en R 1.6.4.1 Variables quantitatives i qualitatives Dades Enquesta Socrative d&lt;-matrix(scan(&quot;http://84.89.132.1/~satorra/dades/ECP2019enquestasocrativeG1.txt&quot;, what=&quot;character&quot;,skip=1),ncol=20,byrow=TRUE); data&lt;-d[-1,]; colnames(data)&lt;-d[1,]; table(data[,4]); ## ## av cd mai ## 12 13 7 round(100*prop.table(table(data[,4], data[,1]),2),1); ## ## 0 1 ## av 42.1 30.8 ## cd 36.8 46.2 ## mai 21.1 23.1 pie(table(data[,4]), main=&quot;fer-se el llit&quot;) ## interess assignatura aggregate(as.numeric(data[,7]), list(data[,4]), mean) ## Group.1 x ## 1 av 6.625000 ## 2 cd 5.923077 ## 3 mai 4.571429 ## tirada de dues monedes table(data[,14]) ## ## 0 1 2 3 ## 2 11 15 4 round(prop.table(table(data[,14])),2) ## ## 0 1 2 3 ## 0.06 0.34 0.47 0.12 "],["seminaris-setmana-1.html", "Capítol 2 Seminaris Setmana 1 2.1 Programació amb R 2.2 Comentari Deure 1.", " Capítol 2 Seminaris Setmana 1 2.1 Programació amb R Introducció a la Programació amb R per al Mètodes Estadístics Aplicats en Ciències Polítiques. Dades pels projectes. 2.2 Comentari Deure 1. Veure aparatat deures: 3. "],["homework.html", "Capítol 3 Llista de problemes 3.1 Problema 1 3.2 Problema 2 3.3 Problema 3 3.4 Problema 4 3.5 Problema 5", " Capítol 3 Llista de problemes 3.1 Problema 1 NOTA: Descarrega la plantilla de solució problema 1 en Rmd. En el link https://griu.github.io/meacp_2021/data/dataXY.dat hi han les dues variables ESPVIDA i CALORIES del fitxer PAISOS.SAV (són lesperança de vida y les calories per habitant en diferents paisos del mon). Feu: Utiliza el program (Excel, SPSS o R) que coneguis. La lectura de les dades amb R seria dataXY&lt;-read.table(&#39;https://raw.githubusercontent.com/griu/griu.github.io/main/meacp_2021/data/dataXY.dat&#39;, header=TRUE, dec=&quot;,&quot;, sep=&quot;;&quot;) Una descripció breu univariant de cada una de les variables; summary(dataXY) ## CALORIES ESPVIDA ## Min. :1505 Min. :39.00 ## 1st Qu.:2248 1st Qu.:55.77 ## Median :2614 Median :67.55 ## Mean :2661 Mean :64.57 ## 3rd Qu.:3166 3rd Qu.:72.88 ## Max. :3947 Max. :79.50 Un diagrama de dispersió de ESPVIDA vs CALORIES. Comenta si sobserva o no associació entre aquests dues variables. library(ggplot2) ggplot(dataXY, aes(x=CALORIES, y=ESPVIDA)) + geom_point() Comenta si la associació observada justifica o no parlar de causalitat. 3.2 Problema 2 Considera les dades a PAISOS.SAV, lectura de dades en R: library(foreign) data &lt;- read.spss(&quot;https://griu.github.io/meacp_2021/data/PAISOS.SAV&quot;, use.value.labels = TRUE, to.data.frame = TRUE, use.missings =TRUE) Quins són els països que tenen menys de 47 anys desperança de vida? Quants països tenen menys dun terç de la seva població alfabetitzada? I daquests, quants tenen un PIB per càpita superior a 1.000 dòlars? Quina és la mitjana del nombre de diaris que es llegeixen al món? Hi ha diferències en la lectura de diaris segons nivell de desenvolupament humà? Creus que a Espanya sen llegeixen pocs? perquè? Quina és la mitjana dhabitants per metge? Quin és el valor daquesta mitjana en cada un dels tres nivells de desenvolupament humà en què shan classificat els països? Hi ha diferències significatives entre elles? En relació al fitxer de dades PAISOS.SAV, tria una variable Y del teu interès i descriu la variació de la mateixa emprant un altre variable del fitxer de dades. En aquest procés, ajusta un model de regressió lineal simple entre la variable depenent i la variable explicativa, descriu els resultats de la regressió lineal simple, i comprova que la hipòtesi de linealitat es plausible en aquestes dades. Si veus que la linealitat no es plausible, efectua la corresponent transformació prèvia de les variables. Recull els residus, I fes un gràfic dels residus vs. la variable depenent ajustada. Fes un breu resum de les conclusions que creus que es desprenen de la teva anàlisi. Explica també les limitacions de lanàlisi. 3.3 Problema 3 En relació a les dades de PAISOS.SAV. Investiga la variació de ESPVIDA en funció de CALORIES, controlant o no per altres variables explicatives. Inspecciona els residus de la regressió. Fes un breu resum de les conclusions que creus que es desprenen de la dependencia de ESPVIDA i CALORIES. 3.4 Problema 4 Considera les dades bank.sav (veure els fitxers de dades que hi ha a la web de lassignatura) de salaris de treballadors del sector de banca. Imagina que hi ha un plet en aquesta empresa sobre discriminació per raó de gènere. De fet, el salari actual dels homes és molt superior al de les dones. Fes les anàlisis de regressió simple i múltiple, amb les interpretacions i arguments corresponents, que aporten evidència empírica en defensa de lassociació que ha iniciat el plet contra lempresa. Dades: library(foreign) d &lt;- read.spss(http://84.89.132.1/~satorra/dades/bank2.sav, to.data.frame=TRUE) names(d) Inicialment fes un breu descriptiu (freqüències, mitjanes,) de les variables del fitxer segons siguin categòriques o contínues. Visualitza un scatterplot (gràfic de dispersió) de cadascuna de les variables contínues respecte a la variable del salari actual. Comenta la linealitat o no, de les relacions observades. Calcula la correlació de Pearson de cadascuna de les variables contínues i la variable salari actual. Transforma la variable Sexo a una variable numèrica. Utilitza una regressió lineal simple per tal de verificar que efectivament hi ha diferències salarials entre homes i dones. Explora ara diferents models lineals múltiples usant com a variable depenent Salari Actual i com a regressors del model la variable sexe i altres factors de control (Nivell educatiu, Mesos des del contracte, experiència prèvia,) . Un cop escollit el model anota quins son els coeficients del model, el seu nivell de significació, quin nivell dajust ha obtingut el model, això com lhistograma dels residus i el gràfics de dispersió dels valors ajustats sobre els residus. Comenta breument els diferents resultats Incorpora en el model la variable categòrica Categoria laboral i reporta els mateixos elements que en el punt anterior. Escriu quines son les conclusions principals que sextreuen del model pel que fa a la qüestió de la discriminació del salari. 3.5 Problema 5 Deure: Regressio Logistica Considera les dades de lenquesta postelectoral del CIS corresponent a les eleccions generals de 1986, fitxer CIS1542.SAV: library(foreign) d&lt;-read.spss(&quot;http://84.89.132.1/~satorra/dades/cis1542.sav&quot;, to.data.frame=TRUE) names(d) La variable dependent que vols explicar és ABST86, una variable dicotòmica. Considera com a variables explicatives les següents: MIDA_HAB, SEXE, EDAT, CASAT, ATURAT. Les dues últimes variables són categòriques. Considera la recodificació següent: CASAT, amb valor 1 si EST_CIV=2 i 0 en els altres casos ATURAT, amb valor 1 si SIT_LAB=2 i 0 en els altres casos Estima un model de regressió logística per tal dexplicar labstenció en funció daquestes 5 variables sociològiques. Treballa els següents punts: Quines de les variables incloses en el model són significatives (al 5% de significació)? Escriu la equació estimada que relaciona el logit de la probabilitat dabstenir-se amb les variables explicatives. És lineal aquesta equació? Escriu la equació estimada que relaciona la probabilitat dabstenir-se amb les variables explicatives. És lineal aquesta equació ? Segons el model estimat, quina probabilitat té dabstenir-se una noia soltera, que viu en una població de 60.000 habitants, que té 27 anys, que te una feina. Al mateix per una amiga seva, amb les mateixes característiques, però que està casada i ha perdut la seva feina. Considera ara les dones casades i que viuen en una població de 60.000 habitants. Calcula el grafic defectes sobre la probabilitat abstenció, de la varible Edat condicionat a si esta o no aturat (pots usar, si vols la funció visreg() vista a classe). El mateix que 5. pero pel grup dhomes. Comenta les principals diferencies o semblances entre els 2 gràfics anteriors. "]]
