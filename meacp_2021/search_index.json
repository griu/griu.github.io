[["index.html", "Diari de les Classes de Mètodes Estadístics Aplicats (21703). Curs 2020-2021 Introducció", " Diari de les Classes de Mètodes Estadístics Aplicats (21703). Curs 2020-2021 Ferran Carrascosa Mallafrè 2021-01-10 Introducció Aquesta web té com a objectiu donar suport als continguts de les clases de teoría y seminaris del curs 2020-2021 de Mètodes Estadístics Aplicats (21703). Els continguts de la web sestructuren de la següent forma: Diari dapunts de clase de teoria Diari dapunts dels seminaris Deures del curs "],["teoria-setmana-1-2020-01-13.html", "Capítol 1 Teoria Setmana 1 (2020-01-13) 1.1 Avaluació 1.2 Bibliografia 1.3 Introducció conceptes Estadística 1.4 Gender gap, at birth 1.5 With Arbuthnotts data, collected on years 1629 to 1710 1.6 Distribució duna variable, distribució normal, altres distribucions", " Capítol 1 Teoria Setmana 1 (2020-01-13) Discussió sobre: Logística del curs: Teoria i seminaris: Horaris Canals: Aula global, Collaborate, Web de curs El PDA Avaluació: Participació seminaris (15%), Treball (35%), Examen Final (50%) Disseny del curs: Conceptes, dades, programari Eina de treball: R 1.1 Avaluació 1.1.1 El treball Consulta la Guía del Treball de fi de curs. Consulta a lAula global els Exemples de treballs danys anteriors. 1.1.2 Exàmens Lexamen serà online. Consulta a lAula global els Exàmens danys anteriors. 1.1.3 Participació Cada setmana a la secció de la Llista de deures 11, es publicarà un deure que shaurà dentregar en una tasca de laula global. 1.2 Bibliografia Mètodes aplicats a Ciències polítiques AnalizaR Datos Políticos. Bookdown. 2020. Quantitative Politics with R. Bookdown. November 2019. Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration. Bookdown Quantitative Research Methods for Political Science, Public Policy and Public Administration: 4th Edition With Applications in R. Bookdown General R y Estadística R Markdown: The Definitive Guide. Chapman &amp; Hall/CRC; 2020. R Graphics Cookbook, OReilly Media, Inc. 2nd ed.; 2020. Data Visualization with R. 2018. R for Data Science. OReilly; 2017. (Castellano) An Introduction to Statistical Learning with applications in R. Springer; 2017. 1.3 Introducció conceptes Estadística Introducció a lassignatura. Llibres, la nostra calculadora de butxaca. Interacció entre Teoria (preguntes), Dades, Estadística (conceptes, no fórmules). Un exemple, per començar a rodar. 1.4 Gender gap, at birth Question: Is there a gender birth rate?. At birth, probability of a boy equal to the probability of a girl? What CIA says on this issue? (Wikipedia) CIA estimates that the current world wide sex ratio at birth is 107 boys to 100 girls, 107/207= 0.5169082 1.5 With Arbuthnotts data, collected on years 1629 to 1710 John Graunt was the first person to compile data that showed an excess of male births over female births. He also noticed spatial and temporal variation in the sex ratio, but the variation in his data is not significant. John Arbuthnott was the first person to demonstrate that the excess of male births is statistically significant. John Arbuthnot (1710) used these time series data on the ratios of male to female christenings in London from 1629-1710 to carry out the first known significance test, comparing observed data to a null hypothesis. Arbuthnot, J. 1710. An argument for divine providence. Philosophical Transactions 27:186-190. dat&lt;- read.table(&quot;http://84.89.132.1/~satorra/dades/arbuthnot.txt&quot;, header=TRUE) head(dat) ## year boys girls ## 1 1629 5218 4683 ## 2 1630 4858 4457 ## 3 1631 4422 4102 ## 4 1632 4994 4590 ## 5 1633 5158 4839 ## 6 1634 5035 4820 dim(dat) ## [1] 82 3 names(dat) ## [1] &quot;year&quot; &quot;boys&quot; &quot;girls&quot; attach(dat) mean(boys) ## [1] 5907.098 mean(girls) ## [1] 5534.646 mean(boys/girls) ## [1] 1.070748 total&lt;- boys+girls plot(year,total, col=&quot;blue&quot;, main=&quot;total birth along the years&quot;) mean(boys/(boys+girls)) ## [1] 0.5169751 require(stats) # for lowess, rpois, rnorm lines(year,lowess(total,f=1/6)$y, lty=3, lwd=4) boxplot(boys, girls, names=c(&quot;boys&quot;,&quot;girls&quot;), col=c(&quot;blue&quot;,&quot;magenta&quot;)) boysrate&lt;- boys/(boys+girls) plot(year, boysrate, ylim = c(.49,.53), col=&quot;blue&quot;) abline(h=0.5, col=&quot;red&quot;, lwd=3, lty=3) t&lt;- (mean(boysrate) - 0.5)/(sd(boysrate)/sqrt(length(boysrate))) t ## [1] 21.29243 t.test(boysrate, mu=0.5) ## ## One Sample t-test ## ## data: boysrate ## t = 21.292, df = 81, p-value &lt; 2.2e-16 ## alternative hypothesis: true mean is not equal to 0.5 ## 95 percent confidence interval: ## 0.5153889 0.5185614 ## sample estimates: ## mean of x ## 0.5169751 plot(year, boysrate, ylim = c(.49,.53), col=&quot;blue&quot;, main=&quot;Boysrate values with 95% confidence bound (green lines) &quot;) abline(h=0.5, col=&quot;red&quot;, lwd=3, lty=3) # Intervals abline(h=mean(boysrate), col=&quot;blue&quot;, lwd=.8) lines(year, rep(0.5153889, length(year)) , lty = &#39;dashed&#39;, col = &#39;green&#39;, lwd=3) lines(year, rep(0.5186, length(year)) , lty = &#39;dashed&#39;, col = &#39;green&#39;, lwd=3) # add fill n&lt;- length(year) polygon(c(rev(year), year), c( rev(rep(0.5153889, n )), rep(0.5186, n )), border = NA) 1.5.1 Now with recent USAs data, present day birth records in the United States source(&quot;http://www.openintro.org/stat/data/present.R&quot;) head(present) ## year boys girls ## 1 1940 1211684 1148715 ## 2 1941 1289734 1223693 ## 3 1942 1444365 1364631 ## 4 1943 1508959 1427901 ## 5 1944 1435301 1359499 ## 6 1945 1404587 1330869 dim(present) ## [1] 63 3 mean(present$boys/(present$boys+present$girls)) ## [1] 0.512516 boysrate&lt;- present$boys/(present$boys+present$girls) t.test(boysrate, mu=0.5) ## ## One Sample t-test ## ## data: boysrate ## t = 147, df = 62, p-value &lt; 2.2e-16 ## alternative hypothesis: true mean is not equal to 0.5 ## 95 percent confidence interval: ## 0.5123458 0.5126862 ## sample estimates: ## mean of x ## 0.512516 1.6 Distribució duna variable, distribució normal, altres distribucions Distribució duna variable quantitativa (variable numérica): anàlisi de variància. library(foreign) data= read.spss( &quot;http://84.89.132.1/~satorra/dades/PAISOS.SAV&quot;, use.value.labels = TRUE, to.data.frame = TRUE ) attach(data) names(data) ## [1] &quot;IDH&quot; &quot;NIVELL&quot; &quot;PAIS&quot; &quot;ESPVIDA&quot; &quot;PIB&quot; &quot;ALFAB&quot; ## [7] &quot;CONT&quot; &quot;CALORIES&quot; &quot;HABMETG&quot; &quot;DIARIS&quot; &quot;TV&quot; &quot;SANITAT&quot; ## [13] &quot;AGRICULT&quot; &quot;INDUST&quot; ESPVIDA ## [1] 46.4 52.1 47.5 39.0 50.7 53.5 44.9 50.2 55.6 43.5 47.5 56.5 45.6 ## [14] 47.3 51.0 46.5 60.4 46.0 47.4 65.2 50.4 55.7 48.0 66.7 48.9 45.0 ## [27] 65.5 55.0 47.6 49.4 61.5 56.0 68.5 44.5 56.0 51.5 71.9 67.7 53.7 ## [40] 60.5 63.6 51.0 62.7 62.1 70.4 59.4 49.3 66.3 56.0 64.7 67.6 55.8 ## [53] 64.8 63.3 69.6 57.5 68.8 51.3 67.9 69.9 66.4 65.2 70.3 69.3 66.0 ## [66] 73.6 71.2 70.0 58.8 67.8 69.0 67.1 71.1 76.3 66.5 70.9 70.0 71.5 ## [79] 67.5 71.5 73.6 64.9 72.8 76.0 71.3 73.8 70.2 66.3 67.6 62.9 70.8 ## [92] 70.5 71.7 69.0 72.5 70.8 71.6 67.5 53.5 70.0 72.0 72.1 75.6 69.6 ## [105] 71.1 77.6 74.6 69.7 71.6 77.0 73.1 75.5 75.3 76.5 77.6 78.6 70.5 ## [118] 74.8 77.6 76.2 74.9 77.5 77.4 77.4 76.4 76.9 73.8 75.7 76.2 76.0 ## [131] 76.0 78.2 76.9 75.3 78.2 79.5 75.7 78.0 72.0 76.1 68.5 66.0 63.1 ## [144] 67.1 75.3 63.7 71.1 43.5 50.2 65.2 56.6 57.6 52.0 53.0 46.5 51.6 ## [157] 55.4 47.0 74.2 48.3 summary(ESPVIDA) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 39.00 55.67 67.60 64.50 72.58 79.50 hist(ESPVIDA, col=&quot;blue&quot;) boxplot(ESPVIDA, col=&quot;blue&quot;) 1.6.1 Valor estandarditzat duna variable # variable centrads head(ESPVIDA - mean(ESPVIDA)) ## [1] -18.10437 -12.40437 -17.00437 -25.50437 -13.80437 -11.00437 # variable estandarditzada head((ESPVIDA - mean(ESPVIDA))/sd(ESPVIDA)) ## [1] -1.715521 -1.175405 -1.611288 -2.416725 -1.308065 -1.042744 # Amb R head(scale(ESPVIDA)) ## [,1] ## [1,] -1.715521 ## [2,] -1.175405 ## [3,] -1.611288 ## [4,] -2.416725 ## [5,] -1.308065 ## [6,] -1.042744 1.6.2 Distribució Normal We now investigate the probability distribution that is most central to statistics: the normal distribution. If we are confident that our data are nearly normal, that opens the door to many powerful statistical methods. Here well describe this distribution and assess the normality of our data. Bitllet de 10 marcs: Carl Friedrich Gauss (1777 - Gotinga;1855) 1.6.2.1 Distribució de notes destudiants Veure exemple enllaç. 1.6.3 Exemple amb la variable diners en butxaca (estudiants de MQ III) Dades_enq_paper (diners en butxaca, genere): datadiners&lt;-read.table(&quot;http://84.89.132.1/~satorra/dades/ECP2019diners.txt&quot;, header=TRUE) names(datadiners) ## [1] &quot;diners&quot; &quot;genere&quot; attach(datadiners) summary(diners) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.000 1.000 7.995 16.249 21.625 100.000 boxplot(diners) hist(diners) boxplot(diners ~ genere, col=c(&quot;blue&quot;,&quot;violet&quot;)) aggregate(diners, list(genere), mean) ## Group.1 x ## 1 0 18.30667 ## 2 1 13.30833 Diners en butxaca: distribució normal? qqnorm(datadiners$diners) qqline(datadiners$diners ,col=&quot;red&quot;, lwd=3) 1.6.3.1 Log de diners en butxaca: distribució normal? qqnorm(log(datadiners$diners+ .1)) qqline(log(datadiners$diners +.1),col=&quot;red&quot;, lwd=3) 1.6.3.2 log de diners en butxaca (no zero): distribució normal? ind&lt;- datadiners$diners &gt; 0 qqnorm(log(datadiners$diners[ind])) qqline(log(datadiners$diners[ind]),col=&quot;red&quot;, lwd=3) 1.6.4 Altres distribucions univariants Distribucions univariants en R 1.6.4.1 Variables quantitatives i qualitatives Dades Enquesta Socrative d&lt;-matrix(scan(&quot;http://84.89.132.1/~satorra/dades/ECP2019enquestasocrativeG1.txt&quot;, what=&quot;character&quot;,skip=1),ncol=20,byrow=TRUE); data&lt;-d[-1,]; colnames(data)&lt;-d[1,]; table(data[,4]); ## ## av cd mai ## 12 13 7 round(100*prop.table(table(data[,4], data[,1]),2),1); ## ## 0 1 ## av 42.1 30.8 ## cd 36.8 46.2 ## mai 21.1 23.1 pie(table(data[,4]), main=&quot;fer-se el llit&quot;) ## interess assignatura aggregate(as.numeric(data[,7]), list(data[,4]), mean) ## Group.1 x ## 1 av 6.625000 ## 2 cd 5.923077 ## 3 mai 4.571429 ## tirada de dues monedes table(data[,14]) ## ## 0 1 2 3 ## 2 11 15 4 round(prop.table(table(data[,14])),2) ## ## 0 1 2 3 ## 0.06 0.34 0.47 0.12 "],["teoria-setmana-2-2020-01-20.html", "Capítol 2 Teoria Setmana 2 (2020-01-20) 2.1 Data Wrangling 2.2 Visualización 2.3 Modelar: Regressió simple", " Capítol 2 Teoria Setmana 2 (2020-01-20) 2.1 Data Wrangling Per modelar conceptes estadístics, cal domar abans les dades (data wrangling). Aquest procés té 3 parts principals. Data Wrangling. Font: G.Glolemun y H.Wickham, 2017 2.1.1 Els data frames 2.1.1.1 Gapminder Per comprendre levolució de la riquesa i lesperança de vida de les persones a nivell de país i continent calen dades. Our mission is to fight devastating ignorance with a fact-based worldview everyone can understand.  Gapminder Hans Rosling de Gapminder feb.2006, va popularitzar Trendalyzer, en una famosa conferencia TED Talk (14,6M de visualitzacions). Trendalyzer, posteriorment adquirida por Google, permetia visualitzar fins a 5 dimensions. Actualment esta disponible en el següent enllaç. library(gapminder) library(knitr) class(gapminder) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; head(gapminder) ## # A tibble: 6 x 6 ## country continent year lifeExp pop gdpPercap ## &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Afghanistan Asia 1952 28.8 8425333 779. ## 2 Afghanistan Asia 1957 30.3 9240934 821. ## 3 Afghanistan Asia 1962 32.0 10267083 853. ## 4 Afghanistan Asia 1967 34.0 11537966 836. ## 5 Afghanistan Asia 1972 36.1 13079460 740. ## 6 Afghanistan Asia 1977 38.4 14880372 786. dim(gapminder) ## [1] 1704 6 2.1.2 Importació de dades 2.1.2.1 Dades amb separador cat(paste0(readLines(&quot;www/data/mtcars.csv&quot;, n = 6), collapse=&quot;\\n&quot;)) ## &quot;mpg&quot;,&quot;cyl&quot;,&quot;disp&quot;,&quot;hp&quot;,&quot;drat&quot;,&quot;wt&quot;,&quot;qsec&quot;,&quot;vs&quot;,&quot;am&quot;,&quot;gear&quot;,&quot;carb&quot; ## 21,6,160,110,3.9,2.62,16.46,0,1,4,4 ## 21,6,160,110,3.9,2.875,17.02,0,1,4,4 ## 22.8,4,108,93,3.85,2.32,18.61,1,1,4,1 ## 21.4,6,258,110,3.08,3.215,19.44,1,0,3,1 ## 18.7,8,360,175,3.15,3.44,17.02,0,0,3,2 mtcars &lt;- read.table(&quot;www/data/mtcars.csv&quot;, dec=&quot;.&quot;,sep=&quot;,&quot;, header=TRUE) Los parámetros especificados son: dec: El separador decimal. En Europa se acostumbra a utilizar la coma , sep: El separador de columnas. Es habitual usar también ; y  cuando es un tabulador. header: Indica si la primera fila contiene el nombre de las variables o no. En el caso de mtcars (separador por comas) es más simple usar read.csv. mtcars &lt;- read.csv(&quot;www/data/mtcars.csv&quot;) dim(mtcars) ## [1] 32 11 Cuando el csv es europeo, , decimal y ; como separador, se utiliza read.csv2(). kable(head(mtcars)) mpg cyl disp hp drat wt qsec vs am gear carb 21.0 6 160 110 3.90 2.620 16.46 0 1 4 4 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4 22.8 4 108 93 3.85 2.320 18.61 1 1 4 1 21.4 6 258 110 3.08 3.215 19.44 1 0 3 1 18.7 8 360 175 3.15 3.440 17.02 0 0 3 2 18.1 6 225 105 2.76 3.460 20.22 1 0 3 1 2.1.2.2 Texto con ancho fijo cat(paste0(readLines(&quot;www/data/fwf-sample.txt&quot;, n = 6), collapse=&quot;\\n&quot;)) ## John Smith WA 418-Y11-4111 ## Mary Hartford CA 319-Z19-4341 ## Evan Nolan IL 219-532-c301 Para leer texto de ancho fijo, se utiliza read.fwf(). fwf_sample &lt;- read.fwf(&quot;www/data/fwf-sample.txt&quot;, widths=c(20,10,12) , col.names=c(&quot;name&quot;, &quot;state&quot;, &quot;ssn&quot;)) widths: Son los anchos de cada variable. col.names: Nombres de las variables. 2.1.2.3 Leer Excel library(readxl) dataXlsx &lt;- read_excel(&quot;www/data/data.xlsx&quot;) dim(dataXlsx) ## [1] 19 6 2.1.2.4 Leer SPSS library(foreign) dataSAV &lt;- read.spss(&quot;http://psych.colorado.edu/~carey/Courses/PSYC7291/DataSets/SPSS/crime.sav&quot;, to.data.frame =TRUE, use.value.labels = TRUE) dim(dataSAV) ## [1] 50 8 2.1.2.5 Leer RData Leer objetos de R. load(&quot;www/data/rStateDataSold.RData&quot;) dim(rStateDataSold) ## [1] 192 8 2.1.2.6 Guardar RData Guardar varios objetos de R. save(dataXlsx, dataSAV, rStateDataSold, file=&quot;www/temp/EjemploSave2.RData&quot;) 2.1.3 Dades ordenades Datos ordenados es un conjunto de datos que ha sido estructurado de forma que cada variable es una columna y cada observación (o caso) es una fila. - H. Wickham 2013. Journal of Statistical Software Para resaltar la importancia de esta etapa, G.Glolemun y H.Wickham, 2017 utilizan las siguiente cita y su posterior adaptación. Todas las familias felices se parecen unas a otras, pero cada familia infeliz lo es a su manera.  León Tolstoy Todos los set de datos ordenados se parecen unos a otros, pero cada set de datos desordenado lo es a su manera  Hadley Wickham En la misma referencia, se explica tres reglas que hacen que un conjunto de datos sea ordenado: Cada variable debe tener su propia columna. Cada observación debe tener su propia fila. Cada valor debe tener su propia celda. También se utiliza la siguiente figura para visualizar mejor estas reglas. Imagen: Reglas que hacen que un conjunto de datos sea ordenado: las variables están en columnas, las observaciones en filas y los valores en celdas. (Fuente: G.Glolemun y H.Wickham, 2017 Com puedes ver, la definición de tidy data, equipara las columnas de la tabla con el concepto de Variable, así como las filas a observaciones, hecho que simplifica enormemente las posteriores fases de analisis de la información. 2.1.4 Transformació El universo de Tydiverse consiste en una colección de packages de R orientados al Data Science. Se recomienda la consulta del libro online R para Ciencia de Datos. El package dplyr, al igual que ggplot2, está desarrollado por Hadley Wickham. Este paquete, supone un cambio de filosofía en la forma de trabajar con los datos y se está transformando en un nuevo estándar en R. 2.1.4.1 Dplyr: arrange, filter, select arange: Ordena los registros de un data frame. filter: Filtra a partir de un conjunto condiciones lógicas. select: Selecciona las variables. Países asiáticos con PIB per cápita inferior a 1000 $ en 2007. suppressPackageStartupMessages(library(tidyverse)) pais07Sel &lt;- gapminder %&gt;% arrange(desc(lifeExp)) %&gt;% filter(continent==&#39;Asia&#39; &amp; gdpPercap &lt; 1000 &amp; year ==2007 ) %&gt;% dplyr::select(country,lifeExp,gdpPercap) kable(pais07Sel) country lifeExp gdpPercap Myanmar 62.069 944.0000 Afghanistan 43.828 974.5803 Observa que no necesitan de comillas para referirse a las variables. También utilizan el operador %&gt;% llamado pipe. Éste sustituye el parámetro de entrada de datos. De esta forma, permite escribir las operaciones de izquierda a derecha facilitando así su lectura. 2.1.4.2 Dplyr: mutate, group_by, summarise mutate: Crea o modifica las variables del data frame. group_by: Especifica una o varias variables de agrupación. summarise: define los agregados de las variables originales. Esperanza de vida y PIB per cápita medio por continente y año. continent_year &lt;- gapminder %&gt;% arrange(continent,year) %&gt;% mutate(lifeExp_total = lifeExp * pop , gdp_total = gdpPercap * pop) %&gt;% group_by(continent,year) %&gt;% dplyr::summarize(n_countries=n() , lifeExp = sum(lifeExp_total ) / sum(pop ) , gdp_capita = sum(gdp_total) / sum(pop) , pop = sum(pop)) kable(continent_year %&gt;% head(10)) continent year n_countries lifeExp gdp_capita pop Africa 1952 52 38.79973 1311.221 237640501 Africa 1957 52 40.94031 1444.952 264837738 Africa 1962 52 43.09925 1540.599 296516865 Africa 1967 52 45.17721 1774.847 335289489 Africa 1972 52 47.21229 2063.171 379879541 Africa 1977 52 49.20883 2244.799 433061021 Africa 1982 52 51.01744 2295.192 499348587 Africa 1987 52 52.82479 2180.764 574834110 Africa 1992 52 53.37292 2071.615 659081517 Africa 1997 52 53.28327 2098.865 743832984 Para la evolución de los continentes en ggplot2, es útil el geom_path() library(ggrepel) ggplot(continent_year, aes(x=gdp_capita , y=lifeExp , color =continent)) + geom_path() + scale_x_log10() + geom_text_repel(aes(label=year), size=2, color=&quot;black&quot;) + labs(title=&quot;Evolución continentes (ponderado)&quot;) Figura 2.1: Evolución de los continentes El gráfico muestra la traza que han recorrido los continentes en sus valores medios de PIB per cápita y Esperanza de vida. Se confirma la mayor progresión de Asia. Vemos que, como América y Europa, en media tienen un comportamiento bastante paralelo. Se observa como el recorrido de África, aunque partiendo de valores muy inferiores, ha sido positiva y ha incrementado de forma similar el resto de continentes. 2.2 Visualización Un simple gráfico ha brindado más información a la mente del analista de datos que cualquier otro dispositivo. - John Tukey 2.2.1 Estructura básica ggplot2 es un sistema coherente para hacer gráficos. suppressPackageStartupMessages(library(HistData)) ggplot(data= Galton, mapping = aes(x=parent, y= child)) + geom_point() Figura 2.2: Altura padres e hijos (Galton, 1885) La altura de los padres es la media entre la altura del padre y 1.08 veces la de la madre. En los datos hay 205 padres diferentes y 928 hijos. Los datos fueron tabulados y por lo tanto discretizado. Para visualizar los datos resulta útil introducir aleatoriedad con jitter. ggplot(data= Galton, mapping = aes(x=parent, y= child)) + geom_jitter() Figura 2.3: Jitter altura padres e hijos (Galton, 1885) Los componentes mínimos son: ggplot define el conjunto de datos en el parámetro data que debería contener todas las variables del gráfico. geom_&lt;función&gt;: Define el tipo de gráfico. Por ejemplo, geom_point es un gráfico de puntos. mapping: define mapeo de parámetros estéticos (x, y) a través de la función aes(). A diferencia de plot, ggplot permite asignar el gráfico a un objeto R. p1 &lt;- ggplot(Galton, aes(x=parent, y= child)) + geom_jitter() Posteriormente, puedes añadirle otros elementos gráficos. p1 &lt;- p1 + geom_smooth(method=&#39;lm&#39;, se=FALSE, formula = y~x, aes(color = &quot;lm&quot;)) + geom_abline(aes(intercept = 0, slope = 1, color = &quot;Diagonal y = x&quot;)) + labs(title = &quot;Relación altura padres e hijos (Galton, 1885)&quot; ,x = &quot;Media altura padres (pulgadas)&quot;, y = &quot;Altura hijos (pulgadas)&quot;) p1 Figura 2.4: Regresión Simple y recta diagonal altura padres e hijos (Galton, 1885) Si defines el mapeo de estéticos en ggplot ya no es necesario definirlos en los geoms. 2.2.2 Otros geoms Otros ejemplos de geoms con los datos de gapminder en 2007. library(ggrepel) suppressPackageStartupMessages(library(cowplot)) paises07 &lt;- as.data.frame(gapminder %&gt;% filter(year==2007)) # paises en 2007 p1 &lt;- ggplot(paises07, aes(x=lifeExp)) + geom_histogram() p2 &lt;- ggplot(paises07, aes(x=continent, fill=continent)) + geom_bar() p3 &lt;- ggplot(paises07, aes(y=lifeExp, fill=continent)) + geom_boxplot() p4 &lt;- ggplot(paises07 %&gt;% arrange(desc(lifeExp)) %&gt;% head(25), aes(x=gdpPercap, y=lifeExp)) + geom_point() + geom_label_repel(aes(label=country), size=3) # arrange two plots into one column plot_grid(p1, p2, p3, p4, labels = c(&quot;histograma&quot;,&quot;barras&quot;,&quot;boxplot&quot;,&quot;Etiquetas&quot;), ncol = 2) 2.2.2.1 Panel de datos facet_wrap() library(datos) p00 &lt;- ggplot(paises , aes(x=pib_per_capita , y=esperanza_de_vida , color=continente , size=poblacion , label=pais))+ geom_point() + scale_x_log10() + facet_wrap(~anio)+ labs(title=&quot;Paises en 2007&quot;) p00 Figura 2.5: Más facet_wrap() y facet_grid() 2.2.2.2 Etiquetas geom_label() paises07 &lt;- paises %&gt;% filter(anio == 2007) p07 &lt;- ggplot(paises07 , aes(x=pib_per_capita , y=esperanza_de_vida , color=continente , size=poblacion))+ geom_point() + scale_x_log10() + labs(title=&quot;Paises en 2007&quot;)+ geom_label(data=paises07 %&gt;% filter(pais==&quot;China&quot;) , nudge_y=2 , aes(label=pais) , size=4 , color=&quot;black&quot;) p07 Figura 2.6: Más geom_label() 2.2.2.3 Paleta colores scale_colour_brewer() p07 &lt;- p07 + scale_colour_brewer( palette = &quot;Dark2&quot;) p07 Figura 2.7: Más paletas COLORBREWER 2.2.2.4 Zoom coord_cartesian() p07 &lt;- p07 + coord_cartesian( xlim=c(300,5000) , ylim=c(38,45)) p07 Figura 2.8: Más coord_cartesian() 2.2.2.5 Temas theme_bw() p07 &lt;- p07 + theme_bw() p07 Figura 2.9: Más en ggtheme 2.2.2.6 Gráficos interactivos ggplotly() suppressPackageStartupMessages(library(plotly)) ggplotly(p00) Figura 2.10: Más R Plotly Mueve el ratón por encima del gráfico para identificar los países. Des de la leyenda puedes filtrar los continentes que se quieren mostrar. 2.3 Modelar: Regressió simple Origen del concepte de regressió aplicat. p1 &lt;- ggplot(data= Galton, mapping = aes(x=parent, y= child)) + geom_jitter()+ geom_smooth(method=&#39;lm&#39;, se=FALSE, formula = y~x, aes(color = &quot;lm&quot;)) + geom_abline(aes(intercept = 0, slope = 1, color = &quot;Diagonal y = x&quot;)) + labs(title = &quot;Relación altura padres e hijos (Galton, 1885)&quot; ,x = &quot;Media altura padres (pulgadas)&quot;, y = &quot;Altura hijos (pulgadas)&quot;) p1 Figura 2.11: Regresión Simple y recta diagonal altura padres e hijos (Galton, 1885) 2.3.0.1 Ingressos i Despeses Es una relació molt comú a la natura. data= read.table(&quot;http://84.89.132.1/~satorra/dades/M2013RegressioSamp.txt&quot;, header =T) names(data) ## [1] &quot;Lrenda&quot; &quot;Ldespeses&quot; &quot;Genere&quot; &quot;Vot&quot; head(data,4) ## Lrenda Ldespeses Genere Vot ## 1 9.477 4.503 1 1 ## 2 11.435 6.147 1 0 ## 3 10.686 4.961 0 0 ## 4 10.407 3.993 0 0 p1 &lt;- ggplot(data= data, mapping = aes(x=scale(Lrenda), y= scale(Ldespeses))) + geom_point() + geom_smooth(method=&#39;lm&#39;, se=FALSE, formula = y~x, aes(color = &quot;lm&quot;)) + geom_abline(aes(intercept = 0, slope = 1, color = &quot;Diagonal y = x&quot;)) + labs(title = &quot;Relació Ingresos i Despeses&quot; ,x = &quot;Log Ingresos Estandarditzat&quot;, y = &quot;Log Despeses Estandarditzat&quot;) p1 Figura 2.12: Regresión Simple y recta diagonal Ingressos y Despeses cor(data$Lrenda,data$Ldespeses) ## [1] 0.4385204 2.3.0.2 PAISOS.SAV Alerta! Correlació no indica sempre causalitat. Poden existir altres factors ocults amb un efecte sobre ambdós factors. library(foreign) data &lt;- read.spss( &quot;http://84.89.132.1/~satorra/dades/PAISOS.SAV&quot;, use.value.labels = TRUE, to.data.frame = TRUE ) names(data) ## [1] &quot;IDH&quot; &quot;NIVELL&quot; &quot;PAIS&quot; &quot;ESPVIDA&quot; &quot;PIB&quot; &quot;ALFAB&quot; ## [7] &quot;CONT&quot; &quot;CALORIES&quot; &quot;HABMETG&quot; &quot;DIARIS&quot; &quot;TV&quot; &quot;SANITAT&quot; ## [13] &quot;AGRICULT&quot; &quot;INDUST&quot; dim(data) ## [1] 160 14 data &lt;- data %&gt;% select(PAIS, ESPVIDA, CALORIES, PIB, HABMETG , ALFAB) data %&gt;% summary() ## PAIS ESPVIDA CALORIES PIB ## Length:160 Min. :39.00 Min. :1505 Min. : 70.0 ## Class :character 1st Qu.:55.67 1st Qu.:2248 1st Qu.: 532.5 ## Mode :character Median :67.60 Median :2614 Median : 1715.0 ## Mean :64.50 Mean :2661 Mean : 5778.5 ## 3rd Qu.:72.58 3rd Qu.:3166 3rd Qu.: 6337.5 ## Max. :79.50 Max. :3947 Max. :36730.0 ## NA&#39;s :8 NA&#39;s :22 ## HABMETG ALFAB ## Min. : 211.0 Min. :12.40 ## 1st Qu.: 642.2 1st Qu.:54.50 ## Median : 2000.0 Median :81.30 ## Mean : 6709.6 Mean :73.39 ## 3rd Qu.: 8901.5 3rd Qu.:94.35 ## Max. :50000.0 Max. :99.00 ## NA&#39;s :18 Observem que dels 160 països, alguns tenen valors faltants en alguna de les variables. En següents sessions es parlará sobre altres enfocs posibles. De moment, un primer tractament és consisteix en filtrar els països amb valors faltants. data &lt;- na.omit(data) rownames(data)&lt;-NULL # reiniciem la numeracio de les files dim(data) ## [1] 120 6 p1 &lt;- ggplot(data= data, mapping = aes(x=scale(CALORIES), y= scale(ESPVIDA))) + geom_point() + geom_smooth(method=&#39;lm&#39;, se=FALSE, formula = y~x, aes(color = &quot;lm&quot;)) + labs(title = &quot;Relació Calories i Esperança de vida&quot; ,x = &quot;Calories por habitant&quot;, y = &quot;ESperança de vida (anys)&quot;) p1 Figura 2.13: Regresión Simple y recta diagonal Calories i Esperança de vida 2.3.1 Regressió simple reg1&lt;- lm(ESPVIDA ~ CALORIES, data=data) summary(reg1) ## ## Call: ## lm(formula = ESPVIDA ~ CALORIES, data = data) ## ## Residuals: ## Min 1Q Median 3Q Max ## -19.0797 -5.0123 0.0774 5.4410 14.6255 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 27.060569 3.135144 8.631 3.35e-14 *** ## CALORIES 0.013896 0.001136 12.232 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 7.107 on 118 degrees of freedom ## Multiple R-squared: 0.5591, Adjusted R-squared: 0.5553 ## F-statistic: 149.6 on 1 and 118 DF, p-value: &lt; 2.2e-16 Estandarditzem les variables i comparem models amb stargazer. reg1s &lt;- lm(scale(ESPVIDA) ~ scale(CALORIES), data=data) # install.packages(&quot;stargazer&quot;) library(stargazer) stargazer(reg1, reg1s, type=&#39;text&#39;) ## ## =========================================================== ## Dependent variable: ## ---------------------------- ## ESPVIDA scale(ESPVIDA) ## (1) (2) ## ----------------------------------------------------------- ## CALORIES 0.014*** ## (0.001) ## ## scale(CALORIES) 0.748*** ## (0.061) ## ## Constant 27.061*** -0.000 ## (3.135) (0.061) ## ## ----------------------------------------------------------- ## Observations 120 120 ## R2 0.559 0.559 ## Adjusted R2 0.555 0.555 ## Residual Std. Error (df = 118) 7.107 0.667 ## F Statistic (df = 1; 118) 149.611*** 149.611*** ## =========================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 Observa que \\(0.748^2=0.559\\) . 2.3.1.1 Residus versus predicció plot(reg1,1) data$PAIS[c(34,32,9)] ## [1] &quot;Mauritania &quot; &quot;Guinea &quot; &quot;Guinea Bissau &quot; reg2=lm(ESPVIDA ~ CALORIES + ALFAB, data=data ) anova(reg1,reg2) ## Analysis of Variance Table ## ## Model 1: ESPVIDA ~ CALORIES ## Model 2: ESPVIDA ~ CALORIES + ALFAB ## Res.Df RSS Df Sum of Sq F Pr(&gt;F) ## 1 118 5959.5 ## 2 117 2852.7 1 3106.8 127.42 &lt; 2.2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 stargazer(reg1,reg2, type=&#39;text&#39;) ## ## ===================================================================== ## Dependent variable: ## ------------------------------------------------- ## ESPVIDA ## (1) (2) ## --------------------------------------------------------------------- ## CALORIES 0.014*** 0.007*** ## (0.001) (0.001) ## ## ALFAB 0.278*** ## (0.025) ## ## Constant 27.061*** 25.403*** ## (3.135) (2.183) ## ## --------------------------------------------------------------------- ## Observations 120 120 ## R2 0.559 0.789 ## Adjusted R2 0.555 0.785 ## Residual Std. Error 7.107 (df = 118) 4.938 (df = 117) ## F Statistic 149.611*** (df = 1; 118) 218.659*** (df = 2; 117) ## ===================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 plot(reg2,1) data$PAIS[c(6,9,105)] ## [1] &quot;Uganda &quot; &quot;Guinea Bissau &quot; &quot;Kuwait &quot; plot(data %&gt;% select(ESPVIDA, CALORIES, PIB, HABMETG, ALFAB)) corr_select &lt;- data %&gt;% select(ESPVIDA, CALORIES, PIB, HABMETG, ALFAB) %&gt;% cor(use=&quot;pairwise.complete.obs&quot;) %&gt;% round(3) kable(corr_select) ESPVIDA CALORIES PIB HABMETG ALFAB ESPVIDA 1.000 0.748 0.629 -0.739 0.839 CALORIES 0.748 1.000 0.616 -0.605 0.619 PIB 0.629 0.616 1.000 -0.378 0.524 HABMETG -0.739 -0.605 -0.378 1.000 -0.648 ALFAB 0.839 0.619 0.524 -0.648 1.000 library(ggcorrplot) corr_select %&gt;% ggcorrplot(type = &quot;lower&quot;, lab = TRUE, show.legend = F) # Transformation of variables (linearizing regression) data &lt;- data %&gt;% mutate( LPIB = log(PIB) ,Lhabmetges = log(HABMETG) ) plot(data %&gt;% select(ESPVIDA, CALORIES, LPIB, Lhabmetges, ALFAB)) corr_log_select &lt;- data %&gt;% select(ESPVIDA, CALORIES, PIB, LPIB, HABMETG, Lhabmetges, ALFAB) %&gt;% cor(use=&quot;pairwise.complete.obs&quot;) %&gt;% round(3) corr_log_select %&gt;% ggcorrplot(type = &quot;lower&quot;, lab = TRUE, show.legend = F) reg3 &lt;- lm(ESPVIDA ~ CALORIES + LPIB + Lhabmetges +ALFAB, data=data) stargazer(reg1, reg2, reg3, type=&#39;text&#39;) ## ## ============================================================================================== ## Dependent variable: ## -------------------------------------------------------------------------- ## ESPVIDA ## (1) (2) (3) ## ---------------------------------------------------------------------------------------------- ## CALORIES 0.014*** 0.007*** 0.001 ## (0.001) (0.001) (0.001) ## ## LPIB 1.821*** ## (0.452) ## ## Lhabmetges -2.388*** ## (0.523) ## ## ALFAB 0.278*** 0.165*** ## (0.025) (0.026) ## ## Constant 27.061*** 25.403*** 55.475*** ## (3.135) (2.183) (7.637) ## ## ---------------------------------------------------------------------------------------------- ## Observations 120 120 120 ## R2 0.559 0.789 0.857 ## Adjusted R2 0.555 0.785 0.852 ## Residual Std. Error 7.107 (df = 118) 4.938 (df = 117) 4.098 (df = 115) ## F Statistic 149.611*** (df = 1; 118) 218.659*** (df = 2; 117) 172.404*** (df = 4; 115) ## ============================================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 2.3.2 Regressió lineal simple \\[ Y = \\beta_0 + \\beta_1x + \\epsilon \\] La \\(\\beta_0\\) terme independent La \\(\\beta_1\\) coeficient de regressió La esperança, \\(E(Y)=\\beta_0+\\beta_1E(x)\\) El coeficient, \\(\\beta_1\\) és un increment en el valor esperat de \\(Y\\) dun augmenta unitari en la variable X El \\(\\epsilon\\) és un terme de pertorbació, variable estadística \\(\\epsilonN(0,\\sigma^2)\\), valor esperat zero i variància constant. Noteu que la variància de \\(\\epsilon\\) representa la intensitat de variació de Y al voltant de la recta de regressió \\(Y=\\beta_0+\\beta_1x\\). Ajust de la regressió: \\[ Y = b_0 + b_1x + \\epsilon \\] \\(b_0=27.061\\), \\(b_1=0.014\\), \\(b_0\\) i \\(b_1\\) són estimacions de \\(\\beta_0\\) i \\(\\beta_1\\) respectivament. Totes les estimacions estan subjectes a un error tipus (standard error). En el nostre exemple: lerror tipus de lestimació ´de \\(beta_1=0.014\\) és \\(0.001\\). Coeficient de determinació múltiple, \\(R^2=0.559\\) és a dir, \\(55.9%\\) de la variació de \\(Y\\) és deguda a la variable X. 2.3.3 Regressió lineal múltiple \\[ Y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + \\epsilon \\] El \\(\\beta_0\\) terme independent La \\(\\beta_1\\), \\(\\beta_2\\) coeficients de regressió parcial La Esperança: \\(E(Y)=\\beta_0+\\beta_1E(x_1)+\\beta_2E(x_2)\\) \\(\\beta_2\\) és un increment en el valor esperat de \\(Y\\) dun augment unitari en la variable \\(X_2\\) quan \\(X_1\\) es manté constant. Idem per \\(\\beta_1\\) (versus \\(X_2\\)) \\(\\epsilon\\) terme de perturbació, variable estadística \\(\\epsilonN(0,\\sigma^2)\\), valor esperat zero i variància constant. Noteu que la variància de \\(\\epsilon\\) representa la intensitat de variació de Y al voltant de la recta de regressió \\(Y=\\beta_0+\\beta_1x_1+\\beta_2x_2\\). Regressió estimada: \\[ Y = b_0 + b_1x_1 + b_2x_2 \\] Els coeficients: \\(b_0=25.403\\); \\(b_1=0.007\\); \\(b_2=0.278\\) El \\(R^2=0.044\\) és un \\(4.4%\\) de variació de \\(Y\\) ve explicada per la variació conjunta de \\(X_1\\) i \\(X_2\\). "],["teoria-setmana-3-2020-01-27.html", "Capítol 3 Teoria Setmana 3 (2020-01-27) 3.1 Repas dia anterior 3.2 Interpretació del model 3.3 Variance Inflation Factor (VIF) 3.4 Dades del Bank", " Capítol 3 Teoria Setmana 3 (2020-01-27) 3.1 Repas dia anterior 3.1.0.1 PAISOS.SAV Alerta! Correlació no indica sempre causalitat. Poden existir altres factors ocults amb un efecte sobre ambdós factors. library(foreign) data &lt;- read.spss( &quot;http://84.89.132.1/~satorra/dades/PAISOS.SAV&quot;, use.value.labels = TRUE, to.data.frame = TRUE ) data &lt;- data %&gt;% select(PAIS, ESPVIDA, CALORIES, PIB, HABMETG , ALFAB) data &lt;- na.omit(data) rownames(data)&lt;-NULL # reiniciem la numeracio de les files 3.1.1 Regressió simple data &lt;- data %&gt;% mutate( LPIB = log(PIB) ,Lhabmetges = log(HABMETG) ) reg1 &lt;- lm(ESPVIDA ~ CALORIES, data=data) reg2 &lt;- lm(ESPVIDA ~ CALORIES + ALFAB, data=data ) reg3 &lt;- lm(ESPVIDA ~ CALORIES + LPIB + Lhabmetges +ALFAB, data=data) stargazer(reg1, reg2, reg3, type=&#39;text&#39;) ## ## ============================================================================================== ## Dependent variable: ## -------------------------------------------------------------------------- ## ESPVIDA ## (1) (2) (3) ## ---------------------------------------------------------------------------------------------- ## CALORIES 0.014*** 0.007*** 0.001 ## (0.001) (0.001) (0.001) ## ## LPIB 1.821*** ## (0.452) ## ## Lhabmetges -2.388*** ## (0.523) ## ## ALFAB 0.278*** 0.165*** ## (0.025) (0.026) ## ## Constant 27.061*** 25.403*** 55.475*** ## (3.135) (2.183) (7.637) ## ## ---------------------------------------------------------------------------------------------- ## Observations 120 120 120 ## R2 0.559 0.789 0.857 ## Adjusted R2 0.555 0.785 0.852 ## Residual Std. Error 7.107 (df = 118) 4.938 (df = 117) 4.098 (df = 115) ## F Statistic 149.611*** (df = 1; 118) 218.659*** (df = 2; 117) 172.404*** (df = 4; 115) ## ============================================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 3.1.2 Regressió lineal simple \\[ Y = \\beta_0 + \\beta_1x + \\epsilon \\] La \\(\\beta_0\\) terme independent La \\(\\beta_1\\) coeficient de regressió La esperança, \\(E(Y)=\\beta_0+\\beta_1E(x)\\) El coeficient, \\(\\beta_1\\) és un increment en el valor esperat de \\(Y\\) dun augmenta unitari en la variable X El \\(\\epsilon\\) és un terme de pertorbació, variable estadística \\(\\epsilonN(0,\\sigma^2)\\), valor esperat zero i variància constant. Noteu que la variància de \\(\\epsilon\\) representa la intensitat de variació de Y al voltant de la recta de regressió \\(Y=\\beta_0+\\beta_1x\\). Ajust de la regressió: \\[ Y = b_0 + b_1x + \\epsilon \\] \\(b_0=27.061\\), \\(b_1=0.014\\), \\(b_0\\) i \\(b_1\\) són estimacions de \\(\\beta_0\\) i \\(\\beta_1\\) respectivament. Totes les estimacions estan subjectes a un error tipus (standard error). En el nostre exemple: lerror tipus de lestimació ´de \\(beta_1=0.014\\) és \\(0.001\\). Coeficient de determinació múltiple, \\(R^2=0.559\\) és a dir, \\(55.9%\\) de la variació de \\(Y\\) és deguda a la variable X. 3.1.3 Regressió lineal múltiple \\[ Y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + \\epsilon \\] El \\(\\beta_0\\) terme independent La \\(\\beta_1\\), \\(\\beta_2\\) coeficients de regressió parcial La Esperança: \\(E(Y)=\\beta_0+\\beta_1E(x_1)+\\beta_2E(x_2)\\) \\(\\beta_2\\) és un increment en el valor esperat de \\(Y\\) dun augment unitari en la variable \\(X_2\\) quan \\(X_1\\) es manté constant. Idem per \\(\\beta_1\\) (versus \\(X_2\\)) \\(\\epsilon\\) terme de perturbació, variable estadística \\(\\epsilonN(0,\\sigma^2)\\), valor esperat zero i variància constant. Noteu que la variància de \\(\\epsilon\\) representa la intensitat de variació de Y al voltant de la recta de regressió \\(Y=\\beta_0+\\beta_1x_1+\\beta_2x_2\\). Regressió estimada: \\[ Y = b_0 + b_1x_1 + b_2x_2 \\] Els coeficients: \\(b_0=25.403\\); \\(b_1=0.007\\); \\(b_2=0.278\\) El \\(R^2=0.044\\) és un \\(4.4%\\) de variació de \\(Y\\) ve explicada per la variació conjunta de \\(X_1\\) i \\(X_2\\). 3.2 Interpretació del model 3.2.1 Gráficament 3.2.1.1 Residus versus valors ajustats plot(reg3,1) verifiquem la homoscedasticitat 3.2.1.2 Análisis normalitat Q-Q plot. plot(reg3,2) Densitat residus. plot(density(residuals(reg3))) 3.2.1.3 Outlyers Distancia de Cook. plot(reg3,4) data$PAIS[c(4,35,89)] ## [1] &quot;Sierra Leona &quot; &quot;Sri Lanka &quot; &quot;Gabon &quot; Residus estandarditzats vs leverage plot(reg3,5) 3.2.2 Gràfics de regressio parcial library(car) ## Loading required package: carData ## Warning: package &#39;carData&#39; was built under R version 4.0.3 ## ## Attaching package: &#39;car&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## recode ## The following object is masked from &#39;package:purrr&#39;: ## ## some avPlots(reg3) Per obtenir només un gràfic. avPlots(reg3, ~ CALORIES) 3.3 Variance Inflation Factor (VIF) Manual de Referència Per identificar multicolinealitat entre les variables explicatives es pot usar el VIF o variance inflation factors (VIF). Com més gran es el calor, més alta la multicolinealitat. El VIF de una variable sobté de la regressió daquesta contra la resta de variables del model: Es calcula el VIF per cada variable explicativa i aquelles amb valor més alt seliminen. LA frontera és arbitraria, tot i que sacostuma a considerar valors superiors a 5 com a molt alts library(car) vif(reg3) ## CALORIES LPIB Lhabmetges ALFAB ## 3.250846 3.674479 4.517252 2.524628 3.4 Dades del Bank Dades de salaris en un banc. Imagina que hi ha un plet en aquesta empresa sobre discriminació per raó de gènere. De fet, el salari actual dels homes és molt superior al de les dones. Residus. hist(d$SALBEG) boxplot(SALNOW ~ SEX, data=d) t-test. library(stargazer) mod1 &lt;- lm(SALNOW ~ SEX, data=d) mod2 &lt;- lm(log(SALNOW) ~ SEX, data=d) stargazer(mod1,mod2, type=&#39;html&#39;) Dependent variable: SALNOW log(SALNOW) (1) (2) SEXFemales -6,163.945*** -0.412*** (563.163) (0.031) Constant 16,576.710*** 9.628*** (380.164) (0.021) Observations 474 474 R2 0.202 0.267 Adjusted R2 0.201 0.266 Residual Std. Error (df = 472) 6,106.345 0.340 F Statistic (df = 1; 472) 119.798*** 172.322*** Note: p&lt;0.1; p&lt;0.05; p&lt;0.01 Afegim covariables. plot(SALNOW ~ AGE, data=d) abline(lm(SALNOW ~ AGE, data=d), col=&quot;red&quot;) library(stargazer) mod1 &lt;- lm(SALNOW ~ SEX + AGE, data=d) mod2 &lt;- lm(log(SALNOW) ~ SEX + AGE, data=d) stargazer(mod1,mod2, type=&#39;html&#39;) Dependent variable: SALNOW log(SALNOW) (1) (2) SEXFemales -6,076.561*** -0.404*** (559.165) (0.031) AGE -71.209*** -0.006*** (23.651) (0.001) Constant 19,184.900*** 9.862*** (944.719) (0.052) Observations 474 474 R2 0.217 0.303 Adjusted R2 0.214 0.300 Residual Std. Error (df = 471) 6,054.832 0.332 F Statistic (df = 2; 471) 65.455*** 102.470*** Note: p&lt;0.1; p&lt;0.05; p&lt;0.01 "],["teoria-setmana-4-2020-02-3.html", "Capítol 4 Teoria Setmana 4 (2020-02-3) 4.1 Packages 4.2 Salaries", " Capítol 4 Teoria Setmana 4 (2020-02-3) 4.1 Packages install.packages(texreg) install.packages(lmtest) install.packages(sandwich) 4.2 Salaries El conjunt de dades Salary informa duna mostra de salaris de professors universitaris recopilats durant lany acadèmic 2008-2009 a USA. Addicionalment als salaris en dòlars, les dades inclouen les següents 5 variables: gènere, anys des del Doctorat, anys de servei, disciplina (teoria (1) o aplicat (2)) i rang acadèmic. Hi ha una consulta sobre la possible discriminació salarial per gènere. library(car) names(Salaries) ## [1] &quot;rank&quot; &quot;discipline&quot; &quot;yrs.since.phd&quot; &quot;yrs.service&quot; ## [5] &quot;sex&quot; &quot;salary&quot; dim(Salaries) ## [1] 397 6 4.2.1 Anàlisis univariant suppressPackageStartupMessages(library(tidyverse)) Salaries %&gt;% ggplot(aes(x=salary)) + geom_density()+ labs(title=&quot;Densitat Salaris&quot;) Salaries %&gt;% ggplot(aes(x=log(salary))) + geom_density()+ labs(title=&quot;Densitat Log-Salaris&quot;) Salaries %&gt;% ggplot(aes(x=sex)) + geom_bar() Salaries %&gt;% ggplot(aes(x=rank)) + geom_bar() Salaries %&gt;% ggplot(aes(x=discipline)) + geom_bar() Salaries %&gt;% ggplot(aes(x=yrs.since.phd)) + geom_density() Salaries %&gt;% ggplot(aes(x=log(yrs.since.phd))) + geom_density() Salaries %&gt;% ggplot(aes(x=yrs.service)) + geom_density() Salaries %&gt;% ggplot(aes(x=log(yrs.service))) + geom_density() ## Warning: Removed 11 rows containing non-finite values (stat_density). 4.2.2 Anàlisis bivariant Salaries &lt;- Salaries %&gt;% mutate(log_salary = log(salary) ,log_yrs.since.phd = log(yrs.since.phd) ,yrs.since.phd2 = yrs.since.phd**2 ,log_yrs.service = log(yrs.service+1) ,yrs.service2 = yrs.service**2 ) Salaries %&gt;% select(salary,log_salary,yrs.since.phd,log_yrs.since.phd,yrs.since.phd2) %&gt;% plot() Salaries %&gt;% select(salary,log_salary,yrs.since.phd,log_yrs.since.phd,yrs.since.phd2) %&gt;% cor() %&gt;% round(3) ## salary log_salary yrs.since.phd log_yrs.since.phd ## salary 1.000 0.988 0.419 0.496 ## log_salary 0.988 1.000 0.426 0.520 ## yrs.since.phd 0.419 0.426 1.000 0.915 ## log_yrs.since.phd 0.496 0.520 0.915 1.000 ## yrs.since.phd2 0.305 0.297 0.963 0.790 ## yrs.since.phd2 ## salary 0.305 ## log_salary 0.297 ## yrs.since.phd 0.963 ## log_yrs.since.phd 0.790 ## yrs.since.phd2 1.000 Salaries %&gt;% ggplot(aes(x=sex,y=salary)) + geom_boxplot() Salaries %&gt;% ggplot(aes(x=sex,y=log(salary))) + geom_boxplot() reg1 &lt;- lm(salary~sex, data=Salaries) summary(reg1) ## ## Call: ## lm(formula = salary ~ sex, data = Salaries) ## ## Residuals: ## Min 1Q Median 3Q Max ## -57290 -23502 -6828 19710 116455 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 101002 4809 21.001 &lt; 2e-16 *** ## sexMale 14088 5065 2.782 0.00567 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 30030 on 395 degrees of freedom ## Multiple R-squared: 0.01921, Adjusted R-squared: 0.01673 ## F-statistic: 7.738 on 1 and 395 DF, p-value: 0.005667 Observem que els salaris en homes són $14.088 superiors que en les dones. Això ens diu que, quan comparem els salaris de forma directe, entre homes i dones, amb un nivell de confiança del 95%, hi ha diferències significatives. library(stargazer) logreg1 &lt;- lm(log(salary)~sex, data=Salaries) stargazer(reg1,logreg1, type=&quot;text&quot;) ## ## =========================================================== ## Dependent variable: ## ---------------------------- ## salary log(salary) ## (1) (2) ## ----------------------------------------------------------- ## sexMale 14,088.010*** 0.129*** ## (5,064.579) (0.043) ## ## Constant 101,002.400*** 11.491*** ## (4,809.386) (0.041) ## ## ----------------------------------------------------------- ## Observations 397 397 ## R2 0.019 0.022 ## Adjusted R2 0.017 0.019 ## Residual Std. Error (df = 395) 30,034.610 0.258 ## F Statistic (df = 1; 395) 7.738*** 8.810*** ## =========================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 La comparativa en termes de logaritme neperià del salari, mostra igualment diferencies significatives amb un 95% de confiança. El coeficient 0,129 del gènere, ens diu que els homes, tenen un salari un 12,9% (aproximadament) per sobre de les dones. Incorporem ara nous factor. logreg2 &lt;- lm(log(salary) ~ sex + yrs.since.phd, data= Salaries) stargazer(logreg1, logreg2, type=&quot;text&quot;) ## ## ================================================================== ## Dependent variable: ## ---------------------------------------------- ## log(salary) ## (1) (2) ## ------------------------------------------------------------------ ## sexMale 0.129*** 0.075* ## (0.043) (0.040) ## ## yrs.since.phd 0.008*** ## (0.001) ## ## Constant 11.491*** 11.353*** ## (0.041) (0.041) ## ## ------------------------------------------------------------------ ## Observations 397 397 ## R2 0.022 0.188 ## Adjusted R2 0.019 0.184 ## Residual Std. Error 0.258 (df = 395) 0.235 (df = 394) ## F Statistic 8.810*** (df = 1; 395) 45.715*** (df = 2; 394) ## ================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 Observem que la variable anys des del doctorat guanya molt pes en la regressió, i produeix que la variables gènere informi que els homes guanyen un 7,5% més les dones (a igual nombre de anys des del doctorat), essent ara, aquesta relació, no significativa amb un nivell del confiança del 95%. En aquest cas, el coeficient 0.008 ens diu que per cada any addicional, hi ha un augment del 0,8% del salari. Salaries %&gt;% ggplot(aes(x=yrs.since.phd, y=log(salary), color=sex))+ geom_point() 4.2.3 Realció log-log loglogreg2 &lt;- lm(log(salary) ~ sex + log(yrs.since.phd), data= Salaries) stargazer(logreg1, logreg2, loglogreg2, type=&quot;text&quot;) ## ## ========================================================================================== ## Dependent variable: ## ---------------------------------------------------------------------- ## log(salary) ## (1) (2) (3) ## ------------------------------------------------------------------------------------------ ## sexMale 0.129*** 0.075* 0.076** ## (0.043) (0.040) (0.038) ## ## yrs.since.phd 0.008*** ## (0.001) ## ## log(yrs.since.phd) 0.167*** ## (0.014) ## ## Constant 11.491*** 11.353*** 11.061*** ## (0.041) (0.041) (0.051) ## ## ------------------------------------------------------------------------------------------ ## Observations 397 397 397 ## R2 0.022 0.188 0.278 ## Adjusted R2 0.019 0.184 0.274 ## Residual Std. Error 0.258 (df = 395) 0.235 (df = 394) 0.222 (df = 394) ## F Statistic 8.810*** (df = 1; 395) 45.715*** (df = 2; 394) 75.904*** (df = 2; 394) ## ========================================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 Si agafem els anys dexperiència en termes de logaritme observem 3 coses: El coeficient 0,167 indica que per cada augment del 100% (duplicar) els anys des del doctorat, el salari augmenta un 16,7%. Per altra banda la variable gènere, passa a ser significativa amb un 95% de confiança. La regressió passa a explicar del 18,8% a un 27,8% de la variabilitat del logaritme dels salaris. Salaries %&gt;% ggplot(aes(x=log(yrs.since.phd), y=log(salary), color=sex))+ geom_point() 4.2.4 Realció x**2 logreg22 &lt;- lm(log(salary) ~ sex + yrs.since.phd +yrs.since.phd2, data= Salaries) stargazer(logreg1, logreg2, loglogreg2, logreg22, type=&quot;text&quot;) ## ## ================================================================================================================== ## Dependent variable: ## ---------------------------------------------------------------------------------------------- ## log(salary) ## (1) (2) (3) (4) ## ------------------------------------------------------------------------------------------------------------------ ## sexMale 0.129*** 0.075* 0.076** 0.087** ## (0.043) (0.040) (0.038) (0.035) ## ## yrs.since.phd 0.008*** 0.039*** ## (0.001) (0.003) ## ## log(yrs.since.phd) 0.167*** ## (0.014) ## ## yrs.since.phd2 -0.001*** ## (0.0001) ## ## Constant 11.491*** 11.353*** 11.061*** 11.081*** ## (0.041) (0.041) (0.051) (0.044) ## ## ------------------------------------------------------------------------------------------------------------------ ## Observations 397 397 397 397 ## R2 0.022 0.188 0.278 0.366 ## Adjusted R2 0.019 0.184 0.274 0.361 ## Residual Std. Error 0.258 (df = 395) 0.235 (df = 394) 0.222 (df = 394) 0.208 (df = 393) ## F Statistic 8.810*** (df = 1; 395) 45.715*** (df = 2; 394) 75.904*** (df = 2; 394) 75.720*** (df = 3; 393) ## ================================================================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 Ara no hi ha una interpretació directa. Veiem que és una realció significativa al 95% de confiança en tots els factors. Salaries %&gt;% ggplot(aes(x=yrs.since.phd, y=log(salary), color=sex))+ stat_smooth(method = &quot;lm&quot;, formula = y ~ x + I(x^2), size = 1)+ geom_point() 4.2.5 Interaccions Anem a analitzar la interacció entre gènere i anys des del doctorat. logreg3 &lt;- lm(log(salary) ~ sex * yrs.since.phd , data= Salaries) stargazer(logreg1, logreg2, logreg3, type=&quot;text&quot;) ## ## ============================================================================================ ## Dependent variable: ## ---------------------------------------------------------------------- ## log(salary) ## (1) (2) (3) ## -------------------------------------------------------------------------------------------- ## sexMale 0.129*** 0.075* 0.210*** ## (0.043) (0.040) (0.078) ## ## yrs.since.phd 0.008*** 0.016*** ## (0.001) (0.004) ## ## sexMale:yrs.since.phd -0.008** ## (0.004) ## ## Constant 11.491*** 11.353*** 11.229*** ## (0.041) (0.041) (0.074) ## ## -------------------------------------------------------------------------------------------- ## Observations 397 397 397 ## R2 0.022 0.188 0.197 ## Adjusted R2 0.019 0.184 0.190 ## Residual Std. Error 0.258 (df = 395) 0.235 (df = 394) 0.234 (df = 393) ## F Statistic 8.810*** (df = 1; 395) 45.715*** (df = 2; 394) 32.040*** (df = 3; 393) ## ============================================================================================ ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 logreg4 &lt;- lm(log(salary) ~ sex * yrs.since.phd + rank + discipline , data= Salaries) summary(logreg4) ## ## Call: ## lm(formula = log(salary) ~ sex * yrs.since.phd + rank + discipline, ## data = Salaries) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.68720 -0.11114 -0.00746 0.09789 0.57698 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 11.1613950 0.0593982 187.908 &lt; 2e-16 *** ## sexMale 0.0627753 0.0617296 1.017 0.310 ## yrs.since.phd 0.0006863 0.0032390 0.212 0.832 ## rankAssocProf 0.1536658 0.0337357 4.555 7.02e-06 *** ## rankProf 0.4550346 0.0344904 13.193 &lt; 2e-16 *** ## disciplineB 0.1279222 0.0188376 6.791 4.17e-11 *** ## sexMale:yrs.since.phd -0.0012207 0.0031494 -0.388 0.699 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1819 on 390 degrees of freedom ## Multiple R-squared: 0.5185, Adjusted R-squared: 0.5111 ## F-statistic: 70 on 6 and 390 DF, p-value: &lt; 2.2e-16 logreg5 &lt;- lm(log(salary) ~ sex + yrs.since.phd + yrs.since.phd2 + rank + discipline , data= Salaries) summary(logreg5) ## ## Call: ## lm(formula = log(salary) ~ sex + yrs.since.phd + yrs.since.phd2 + ## rank + discipline, data = Salaries) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.62180 -0.10560 -0.00586 0.10151 0.59825 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 1.111e+01 4.262e-02 260.719 &lt; 2e-16 *** ## sexMale 5.020e-02 3.088e-02 1.626 0.10481 ## yrs.since.phd 1.277e-02 4.522e-03 2.824 0.00498 ** ## yrs.since.phd2 -2.290e-04 7.604e-05 -3.012 0.00277 ** ## rankAssocProf 8.627e-02 4.025e-02 2.143 0.03270 * ## rankProf 3.481e-01 4.945e-02 7.038 8.81e-12 *** ## disciplineB 1.304e-01 1.864e-02 6.997 1.15e-11 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1799 on 390 degrees of freedom ## Multiple R-squared: 0.5293, Adjusted R-squared: 0.522 ## F-statistic: 73.09 on 6 and 390 DF, p-value: &lt; 2.2e-16 avPlots(logreg5) vif(logreg5) ## GVIF Df GVIF^(1/(2*Df)) ## sex 1.036197 1 1.017938 ## yrs.since.phd 41.568673 1 6.447377 ## yrs.since.phd2 29.791275 1 5.458138 ## rank 4.291107 2 1.439270 ## discipline 1.057661 1 1.028426 plot(logreg5,1) 4.2.6 Estimadors robustos AnalizaR Datos Políticos HC0 = es el original de White (Wooldridge 2016) HC1 = Es el que usa el software de Stata HC3 =Es el más conservador, por lo tanto, es muy recomendable library(texreg) ## Version: 1.37.5 ## Date: 2020-06-17 ## Author: Philip Leifeld (University of Essex) ## ## Consider submitting praise using the praise or praise_interactive functions. ## Please cite the JSS article in your publications -- see citation(&quot;texreg&quot;). ## ## Attaching package: &#39;texreg&#39; ## The following object is masked from &#39;package:tidyr&#39;: ## ## extract library(lmtest) ## Loading required package: zoo ## ## Attaching package: &#39;zoo&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## as.Date, as.Date.numeric library(sandwich) logreg5_robust_3 &lt;- coeftest(logreg5, vcov = vcovHC(logreg5, &quot;HC3&quot;)) logreg5_robust_1 &lt;- coeftest(logreg5, vcov = vcovHC(logreg5, &quot;HC1&quot;)) logreg5_robust_0 &lt;- coeftest(logreg5, vcov = vcovHC(logreg5, &quot;HC0&quot;)) models_robust &lt;- list(logreg5, logreg5_robust_0, logreg5_robust_1, logreg5_robust_3) screenreg(models_robust, custom.model.names = c(&quot;sin ES robustos&quot;, &quot;robustos HC0&quot;, &quot;robustos HC1&quot;, &quot;robustos HC3&quot;)) ## ## ========================================================================= ## sin ES robustos robustos HC0 robustos HC1 robustos HC3 ## ------------------------------------------------------------------------- ## (Intercept) 11.11 *** 11.11 *** 11.11 *** 11.11 *** ## (0.04) (0.04) (0.04) (0.04) ## sexMale 0.05 0.05 * 0.05 * 0.05 * ## (0.03) (0.02) (0.02) (0.02) ## yrs.since.phd 0.01 ** 0.01 * 0.01 * 0.01 * ## (0.00) (0.01) (0.01) (0.01) ## yrs.since.phd2 -0.00 ** -0.00 * -0.00 * -0.00 * ## (0.00) (0.00) (0.00) (0.00) ## rankAssocProf 0.09 * 0.09 ** 0.09 ** 0.09 ** ## (0.04) (0.03) (0.03) (0.03) ## rankProf 0.35 *** 0.35 *** 0.35 *** 0.35 *** ## (0.05) (0.04) (0.04) (0.04) ## disciplineB 0.13 *** 0.13 *** 0.13 *** 0.13 *** ## (0.02) (0.02) (0.02) (0.02) ## ------------------------------------------------------------------------- ## R^2 0.53 ## Adj. R^2 0.52 ## Num. obs. 397 ## ========================================================================= ## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05 ## Normalidad plot(logreg5,2) Outlyers plot(logreg5,5) "],["teoria-setmana-5-2020-02-10.html", "Capítol 5 Teoria Setmana 5 (2020-02-10) 5.1 Packages 5.2 Dades de intenció de vot 5.3 Exemple de Vtown data", " Capítol 5 Teoria Setmana 5 (2020-02-10) 5.1 Packages install.packages(&quot;visreg&quot;) 5.2 Dades de intenció de vot Mostra aleatòria de mida n = 800 duna població Variables: despesa, renda, gènere (1/0, home = 1), vot (1/0, partit A = 1) library(foreign) data &lt;- read.spss(&quot;http://84.89.132.1/~satorra/dades/M2014dadesSIM.sav&quot;, to.data.frame = TRUE, use.value.labels = TRUE) dim(data) ## [1] 800 4 library(knitr) kable(head(head(data))) Lrenda Ldespeses Genere Vot 9.477 4.503 1 1 11.435 6.147 1 0 10.686 4.961 0 0 10.407 3.993 0 0 10.814 5.746 0 0 9.944 4.950 0 1 summary(head(data)) ## Lrenda Ldespeses Genere Vot ## Min. : 9.477 Min. :3.993 Min. :0.0000 Min. :0.0000 ## 1st Qu.:10.060 1st Qu.:4.615 1st Qu.:0.0000 1st Qu.:0.0000 ## Median :10.546 Median :4.955 Median :0.0000 Median :0.0000 ## Mean :10.460 Mean :5.050 Mean :0.3333 Mean :0.3333 ## 3rd Qu.:10.782 3rd Qu.:5.550 3rd Qu.:0.7500 3rd Qu.:0.7500 ## Max. :11.435 Max. :6.147 Max. :1.0000 Max. :1.0000 Sobserva un 33,3% en la intenció del vot del partit A. 5.2.1 La Regressió lineal Fins ara, Y era una variable continua. Ara la Y es binaria (pren valors 0 o 1). Segueix essent vàlida la regressió lineal? Veiem com quedaria la regressió lineal versus la loess. data %&gt;% ggplot(aes(Lrenda, Vot))+ geom_jitter(height =0.02)+ geom_smooth(method=&#39;lm&#39;, se=FALSE, formula = y~x, aes(color = &quot;lm&quot;))+ geom_smooth(method=&#39;loess&#39;, se=FALSE, formula = y~x, aes(color = &quot;loess&quot;)) Mirem ara el resum de la regressió lineal. re0 &lt;-lm(Vot ~ Lrenda, data=data) summary(re0) ## ## Call: ## lm(formula = Vot ~ Lrenda, data = data) ## ## Residuals: ## Min 1Q Median 3Q Max ## -1.10516 -0.39910 0.07352 0.37185 1.12443 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.89760 0.15615 18.56 &lt;2e-16 *** ## Lrenda -0.23403 0.01549 -15.11 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.4392 on 798 degrees of freedom ## Multiple R-squared: 0.2224, Adjusted R-squared: 0.2215 ## F-statistic: 228.3 on 1 and 798 DF, p-value: &lt; 2.2e-16 Problemes quan la Y es binaria: La relació es no-lineal Els termes derror són heteroscedàstics El terme derror no té distribució normal plot(re0,1) plot(re0,2) 5.2.2 La Regressió logística Lalternativa és el model de regressió logística: Suposem que \\(Y_{i} \\sim \\mbox{Bernoulli }(p_i)\\), \\(p_i = P(Y_i = 1), \\, i = 1, \\dots, n\\) Transformem: \\[p \\rightarrow odds(p) \\rightarrow Logit(p)\\] on \\(odds(p) = p/(1-p)\\), en català raó de probabilitats. \\(p \\rightarrow odds(p) \\equiv p /(1- p) \\rightarrow Logit(p) = \\ln \\, (odds (p)) = \\ln \\frac{p }{1 - p } \\leftrightarrow p = \\frac{1}{1 + e^{-L }}\\) Model lineal pel $ L = Logit(p) = $: \\(L = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\beta_3 X_3\\) Model no-lineal per p, on: \\(p \\equiv E(Y \\mid X_1, X_2, X_3) = \\frac{1}{1 + e^{-( \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\beta_3 X_3)}}\\)$ versus el model de regressió lineal clàssic que diu que \\(p = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\beta_3 X_3\\). Exemple: Y = INDECIS, X = INGRESSOS \\(P(Y = 1) = p = \\frac{1}{1 + e^{-L_i}} = \\frac{1}{1 + e^{- (\\alpha + \\beta * Lrenda)}}\\). re1&lt;-glm(Vot ~ Lrenda, data=data, family = &quot;binomial&quot;) summary(re1) ## ## Call: ## glm(formula = Vot ~ Lrenda, family = &quot;binomial&quot;, data = data) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.5206 -0.9692 0.4540 0.9087 2.5511 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 12.389 1.027 12.07 &lt;2e-16 *** ## Lrenda -1.208 0.101 -11.96 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1101.02 on 799 degrees of freedom ## Residual deviance: 900.73 on 798 degrees of freedom ## AIC: 904.73 ## ## Number of Fisher Scoring iterations: 4 re1 %&gt;% coef() ## (Intercept) Lrenda ## 12.388980 -1.208374 \\[P(Y = 1) = p = \\frac{1}{1 + e^{- (0.02659931 - 0.14434733 *Ingressos)}}\\] 5.2.3 Interpretació dels paràmetres re1 %&gt;% coef() %&gt;% exp() %&gt;% round(4) ## (Intercept) Lrenda ## 240140.5549 0.2987 $ = 12.388980 - 1.208374 * Lrenda $ \\(exp(-1.208374 )= 0.2987 \\rightarrow 0.2987 - 1 = -0.7013 \\rightarrow odds(p)\\) Decreix un 70% en el canvi de x a X+1 (aproximadament duplicar ingressos ja que estan en escala log). $ ( () - 1) = $ % daugment/decreixement dels odds 5.2.4 Lineal versus Logística data &lt;- data %&gt;% mutate( P_lm_Vot = 2.8975953 - 0.2340296 * Lrenda , P_glm_Vot = 1/(1+ exp(-(12.388980 - 1.208374 * Lrenda )))) %&gt;% arrange(Lrenda ) data %&gt;% select(P_glm_Vot,P_lm_Vot) %&gt;% summary() ## P_glm_Vot P_lm_Vot ## Min. :0.02833 Min. :-0.1864 ## 1st Qu.:0.36861 1st Qu.: 0.3939 ## Median :0.55061 Median : 0.5375 ## Mean :0.55000 Mean : 0.5500 ## 3rd Qu.:0.75337 3rd Qu.: 0.7145 ## Max. :0.97631 Max. : 1.2184 Observem valors poc desitjables negatius i per sobre de 1 en P_lm_Vot. Veiem gràficament data %&gt;% ggplot(aes(Lrenda, Vot))+ geom_jitter(width = 0.15, height =0.05)+ geom_smooth(method=&#39;lm&#39;, se=FALSE, formula = y~x, aes(color = &quot;lm&quot;))+ geom_smooth(method=&#39;loess&#39;, se=FALSE, formula = y~x, aes(color = &quot;loess&quot;))+ geom_line(aes(y=P_glm_Vot,color = &quot;glm-logit&quot;))+ geom_hline(yintercept=c(0,1)) Observa com la corba obtinguda per la regressió logística (glm-logit) captura millor la tendència observada a través de la regressió Loess. Addicionalment la regressió logística defineix una asímptota respecte el 0 i l1 (sacosta, però no arriba a creuar mai). 5.2.5 Regressió logística amb covariants: Lrenda, gènere Ajustem un primer model. suppressPackageStartupMessages(library(stargazer)) #Lineal re2&lt;-lm(Vot ~ Lrenda + Genere, data=data) #Logística re3&lt;-glm(Vot ~ Lrenda + Genere, data=data, family = &quot;binomial&quot;) stargazer(re0,re1,re2, type = &quot;text&quot;) ## ## =============================================================================== ## Dependent variable: ## ----------------------------------------------------------- ## Vot ## OLS logistic OLS ## (1) (2) (3) ## ------------------------------------------------------------------------------- ## Lrenda -0.234*** -1.208*** -0.182*** ## (0.015) (0.101) (0.014) ## ## Genere 0.460*** ## (0.027) ## ## Constant 2.898*** 12.389*** 2.139*** ## (0.156) (1.027) (0.142) ## ## ------------------------------------------------------------------------------- ## Observations 800 800 800 ## R2 0.222 0.425 ## Adjusted R2 0.221 0.423 ## Log Likelihood -450.366 ## Akaike Inf. Crit. 904.732 ## Residual Std. Error 0.439 (df = 798) 0.378 (df = 797) ## F Statistic 228.283*** (df = 1; 798) 294.136*** (df = 2; 797) ## =============================================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 Els coeficients de la part lineal de la regressió logística. re3 %&gt;% coef() %&gt;% round(2) ## (Intercept) Lrenda Genere ## 12.30 -1.32 2.61 Interpretem els coeficients en termes de odds. re3 %&gt;% coef() %&gt;% exp() %&gt;% round(4) - 1 ## (Intercept) Lrenda Genere ## 218904.9754 -0.7339 12.6663 La renta, a igualtat de gènere, ha incrementat en termes absoluts el seu efecte en una disminució de 73% sobre els odds de la intenció de Vot al duplicar els ingressos Per altra banda, els homes tenen un 12% dincrement en els odds de la intenció de Vot que les dones, a igualtat dingressos. 5.2.6 Regressió logística amb covariants: gràfic defectes condicionats La funció visreg() ens resol la visualització del efecte de cada factor condicionat als valors fixes de la resta de variables (utilitza la mediana en numèriques o la moda en factors). En aquest cas veiem lefecte de la renta sobre la intenció de vot, condicionat al gènere. library(visreg) visreg(re3, &quot;Lrenda&quot;, by = &quot;Genere&quot;, band = TRUE, # viualitzem bandes gg = TRUE, # usem ggplot2 overlay=TRUE, # un mateix grafic scale=&quot;response&quot;) + labs(y = &quot;Prob(Vot)&quot;, x = &quot;Lrenda&quot;) Observem com els homes tenen una corba clarament per sobre. També, la variació de la intenció de vot es fa més pronunciada (mes pendent) en les dones en trams de rentes baixes que en homes (efecte no lineal). També podem retornar la variable de Renta a escala normal (Euros) transformant amb la exponencial. visreg(re2, &quot;Lrenda&quot;, by = &quot;Genere&quot;, xtrans = exp, band = TRUE, # viualitzem bandes gg = TRUE, # usem ggplot2 overlay=TRUE, # un mateix grafic scale=&quot;response&quot;) + labs(y = &quot;Prob(Vot)&quot;, x = &quot;Lrenda&quot;) El canvi descala accentua la interpretació anterior, es a dir, major variació en trams de rentes baixes en dones que en homes. Pots profunditzar en el paràmetres de visreg a lajuda: ?visreg # paràmetres dels càlculs. ?plot.visreg # paràmetres del gràfic. 5.3 Exemple de Vtown data La contaminació per residus tòxics en el terreny de dos escoles públiques. Algunes persones pensaven que lescola hauria destar tancada fins que el terreny fos declarat segur. Altres persones argumentaven que els costos no justificaven el risc i volien que es mantingués oberta lescola afectada. SCHOOL: Resposta si volien que lescola estigués tancada (CLOSE) o oberta (OPEN). GENDER: Gènere de lenquestat. LIVED: Anys de residencia al municipi. KIDS: Lenquestat té nens, o no. EDUC: Anys destudis de lenquestat. MEETINGS: Lenquestat ha anat als mítings sobre crisis provocada per la contaminació. CONTAM: Lenquestat creu que la seva propietat ha estat contaminada (o no). Motivació: llegir la noticia Exposició a contaminació de la mare i deficiència en pes (LBW) dels nadons Les dades. library(foreign) da &lt;- as.data.frame(read.spss(&quot;http://84.89.132.1/~satorra/dades/VtTown.sav&quot;, to.data.frame = TRUE)) head(da) ## ID GENDER LIVED KIDS EDUC MEETINGS CONTAM SCHOOL ## 1 1 MALE 35 YES 12 YES YES CLOSE ## 2 2 MALE 5 YES 14 YES NO CLOSE ## 3 3 MALE 21 NO 12 YES YES CLOSE ## 4 4 MALE 6 NO 16 NO NO OPEN ## 5 5 MALE 12 YES 18 NO NO OPEN ## 6 6 MALE 12 YES 16 NO NO OPEN da %&gt;% count(SCHOOL) ## SCHOOL n ## 1 OPEN 87 ## 2 CLOSE 66 da &lt;- da %&gt;% mutate(Y = as.numeric(SCHOOL) -1) da %&gt;% count(Y) ## Y n ## 1 0 87 ## 2 1 66 Lobjectiu és analitzar la propensió de la intenció de tancar lescola fins que no es confirmi que està des contaminada. reg1&lt;- glm(Y ~ LIVED + MEETINGS, binomial, data=da ) summary(reg1) ## ## Call: ## glm(formula = Y ~ LIVED + MEETINGS, family = binomial, data = da) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.0559 -0.8567 -0.5140 0.6189 2.3832 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -0.34850 0.31816 -1.095 0.27336 ## LIVED -0.03575 0.01355 -2.638 0.00833 ** ## MEETINGSYES 2.36882 0.44298 5.347 8.92e-08 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 209.21 on 152 degrees of freedom ## Residual deviance: 160.27 on 150 degrees of freedom ## AIC: 166.27 ## ## Number of Fisher Scoring iterations: 4 Gràficament, visreg(reg1, &quot;LIVED&quot;, by = &quot;MEETINGS&quot;, band = TRUE, # viualitzem bandes gg = TRUE, # usem ggplot2 overlay=TRUE, # un mateix grafic scale=&quot;response&quot;) + labs(y = &quot;Prob(Close)&quot;, x = &quot;LIVED&quot;) Definim un model complert amb un factor de interacció de GENDER y KIDS. da &lt;- da %&gt;% mutate(MALE = 1.0*(GENDER==&quot;MALE&quot;)) lreg2 &lt;- glm(Y ~ LIVED + EDUC+ CONTAM+MEETINGS+MALE+KIDS+ KIDS*MALE ,family=binomial, data= da) summary(lreg2) ## ## Call: ## glm(formula = Y ~ LIVED + EDUC + CONTAM + MEETINGS + MALE + KIDS + ## KIDS * MALE, family = binomial, data = da) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.6027 -0.7557 -0.3091 0.6316 2.3920 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 2.84216 1.44277 1.970 0.04885 * ## LIVED -0.04664 0.01698 -2.748 0.00600 ** ## EDUC -0.20602 0.09320 -2.211 0.02706 * ## CONTAMYES 1.28208 0.48137 2.663 0.00774 ** ## MEETINGSYES 2.41800 0.50966 4.744 2.09e-06 *** ## MALE -2.17443 0.81906 -2.655 0.00794 ** ## KIDSYES -0.67062 0.56561 -1.186 0.23576 ## MALE:KIDSYES 2.22599 0.99911 2.228 0.02588 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 209.21 on 152 degrees of freedom ## Residual deviance: 141.05 on 145 degrees of freedom ## AIC: 157.05 ## ## Number of Fisher Scoring iterations: 5 da &lt;- da %&gt;% mutate(INTER = (1.0*(KIDS==&quot;NO&quot;))*MALE) lreg3 &lt;- glm(Y ~ LIVED + EDUC + CONTAM + MEETINGS+ INTER ,family=binomial, data= da) stargazer(lreg2, lreg3, type=&quot;text&quot;) ## ## ============================================== ## Dependent variable: ## ---------------------------- ## Y ## (1) (2) ## ---------------------------------------------- ## LIVED -0.047*** -0.040** ## (0.017) (0.015) ## ## EDUC -0.206** -0.197** ## (0.093) (0.093) ## ## CONTAMYES 1.282*** 1.299*** ## (0.481) (0.477) ## ## MEETINGSYES 2.418*** 2.279*** ## (0.510) (0.490) ## ## MALE -2.174*** ## (0.819) ## ## KIDSYES -0.671 ## (0.566) ## ## MALE:KIDSYES 2.226** ## (0.999) ## ## INTER -1.731** ## (0.725) ## ## Constant 2.842** 2.182 ## (1.443) (1.330) ## ## ---------------------------------------------- ## Observations 153 153 ## Log Likelihood -70.525 -71.326 ## Akaike Inf. Crit. 157.049 154.652 ## ============================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 Comparem lajust dels dos models. anova( lreg3, lreg2, test = &quot;Chisq&quot;) ## Analysis of Deviance Table ## ## Model 1: Y ~ LIVED + EDUC + CONTAM + MEETINGS + INTER ## Model 2: Y ~ LIVED + EDUC + CONTAM + MEETINGS + MALE + KIDS + KIDS * MALE ## Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi) ## 1 147 142.65 ## 2 145 141.05 2 1.6031 0.4486 Analitzem el canvi defecte dels anys de residencia condicionat a tenir (o no) nens, dins del grup dhomes. visreg(lreg2, &quot;LIVED&quot;, by = &quot;KIDS&quot;, cond=list(MALE=1), # condicionem a ser home band = TRUE, # viualitzem bandes gg = TRUE, # usem ggplot2 overlay=TRUE, # un mateix grafic scale=&quot;response&quot;) + labs(y = &quot;Prob(Close)&quot;, x = &quot;LIVED&quot;) 5.3.1 Anàlisis bivariant preliminar Fem un pas enrere. Com en el cas de la regressió lineal, abans de modelitzar, es interesant fer un breu anàlisis bivariant de les variables que es volen introduir en el model. Veiem un exemple a partir dels quantils de la variable LIVED . quantile(da$LIVED, seq(0,1,0.2)) ## 0% 20% 40% 60% 80% 100% ## 1.0 5.0 10.0 20.0 31.6 81.0 A partir del quantils de la variable podem definir una partició de la variable lived. da &lt;- da %&gt;% mutate(LIVED_T = cut(LIVED, c(-Inf, 5,10, 20, 32,Inf))) da %&gt;% count(LIVED_T) ## LIVED_T n ## 1 (-Inf,5] 40 ## 2 (5,10] 23 ## 3 (10,20] 33 ## 4 (20,32] 27 ## 5 (32, Inf] 30 Mirem-ho ara amb les freqüències relatives de cada fila. da %&gt;% group_by(LIVED_T) %&gt;% summarise(freq_absolutes = n() ,propensio = mean(Y)) ## # A tibble: 5 x 3 ## LIVED_T freq_absolutes propensio ## &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; ## 1 (-Inf,5] 40 0.6 ## 2 (5,10] 23 0.522 ## 3 (10,20] 33 0.394 ## 4 (20,32] 27 0.481 ## 5 (32, Inf] 30 0.133 Incorporem els intervals de confiança. Recorda que la desviació típica de una variable bernoulli(p) on p es la probabilitat de estar Indecís, val: \\[ stdDesv(Y ) = \\sqrt{p*q} \\] on q = 1- p. Per altra banda, lerror estàndard es calcula com: \\[ errStd(Y ) = \\sqrt{p*q / n} \\] on n es el nombre observacions. Daquesta forma, linterval de confiança (95%) es defineix com. \\[\\left[p - 1.96*\\sqrt{p*q / n}, p + 1.96*\\sqrt{p*q / n}\\right]\\] Ara en R. errStd_bin &lt;- function(x) { sqrt(mean(x)*(1-mean(x)) / length(x))} minInt_bin &lt;- function(x) { mean(x) - 1.96 *errStd_bin(x) } maxInt_bin &lt;- function(x) { mean(x) + 1.96 *errStd_bin(x) } RESUM &lt;- da %&gt;% group_by(LIVED_T) %&gt;% summarise(freq_absolutes = n() ,I_minim = minInt_bin(Y ) ,propensio = mean(Y ) ,I_maxim = maxInt_bin(Y )) %&gt;% mutate(freq_relatives = freq_absolutes / sum(freq_absolutes)) RESUM ## # A tibble: 5 x 6 ## LIVED_T freq_absolutes I_minim propensio I_maxim freq_relatives ## &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (-Inf,5] 40 0.448 0.6 0.752 0.261 ## 2 (5,10] 23 0.318 0.522 0.726 0.150 ## 3 (10,20] 33 0.227 0.394 0.561 0.216 ## 4 (20,32] 27 0.293 0.481 0.670 0.176 ## 5 (32, Inf] 30 0.0117 0.133 0.255 0.196 Gràficament, suppressPackageStartupMessages(library(cowplot)) library(scales) p1 &lt;- RESUM %&gt;% ggplot(aes(LIVED_T, freq_relatives)) + geom_bar(stat=&quot;identity&quot;)+ geom_text(aes(label = freq_absolutes), vjust=1.6, color=&quot;white&quot;)+ scale_y_continuous(labels = percent)+ theme_minimal()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+ labs(title=&quot;Freqüencies&quot;) p2 &lt;- RESUM %&gt;% ggplot(aes(LIVED_T, propensio)) + geom_point(size = 1.5) + geom_errorbar(aes(ymin =I_minim, ymax = I_maxim, width = .2))+ scale_y_continuous(labels = percent)+ theme_minimal()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+ labs(title=&quot;Intervals confiança Indecisió&quot;) plot_grid(p1, p2, ncol=2) Mateix anàlisi, sobre la variable MEETINGS : RESUM &lt;- da %&gt;% group_by(MEETINGS ) %&gt;% summarise(freq_absolutes = n() ,I_minim = minInt_bin(Y ) ,propensio = mean(Y ) ,I_maxim = maxInt_bin(Y )) %&gt;% mutate(freq_relatives = freq_absolutes / sum(freq_absolutes)) p1 &lt;- RESUM %&gt;% ggplot(aes(MEETINGS , freq_relatives)) + geom_bar(stat=&quot;identity&quot;)+ geom_text(aes(label = freq_absolutes), vjust=1.6, color=&quot;white&quot;)+ scale_y_continuous(labels = percent)+ theme_minimal()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+ labs(title=&quot;Freqüencies&quot;) p2 &lt;- RESUM %&gt;% ggplot(aes(MEETINGS , propensio)) + geom_point(size = 1.5) + geom_errorbar(aes(ymin =I_minim, ymax = I_maxim, width = .2))+ scale_y_continuous(labels = percent)+ theme_minimal()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+ labs(title=&quot;Intervals confiança Indecisió&quot;) plot_grid(p1, p2, ncol=2) "],["seminaris-setmana-1-2021-01-13.html", "Capítol 6 Seminaris Setmana 1 (2021-01-13) 6.1 Programació amb R 6.2 Comentari Deure 1.", " Capítol 6 Seminaris Setmana 1 (2021-01-13) 6.1 Programació amb R Introducció a la Programació amb R per al Mètodes Estadístics Aplicats en Ciències Polítiques. Dades pels projectes. 6.2 Comentari Deure 1. Veure aparatat deures: 11. "],["seminaris-setmana-2-2021-01-20.html", "Capítol 7 Seminaris Setmana 2 (2021-01-20) 7.1 Comentari dels projectes en grup 7.2 Paquets addicionals 7.3 Correcció deure 1 7.4 Comentari Deure 2", " Capítol 7 Seminaris Setmana 2 (2021-01-20) 7.1 Comentari dels projectes en grup Formació de grups setmana 2021-01-27. Pensar tema. Exploració de propostes de dades pel projecte 7.2 Paquets addicionals Revisió posada a apunt del R install.packages(&quot;stargazer&quot;) install.packages(&quot;ggcorrplot&quot;) 7.3 Correcció deure 1 Solució a laula 7.4 Comentari Deure 2 Veure aparatat deures: 11. "],["seminaris-setmana-3-2021-01-27.html", "Capítol 8 Seminaris Setmana 3 (2021-01-27) 8.1 Comentari dels projectes en grup 8.2 Correcció deure 2 8.3 Comentari Deure 3", " Capítol 8 Seminaris Setmana 3 (2021-01-27) 8.1 Comentari dels projectes en grup Inici tutories per grups. 8.2 Correcció deure 2 Solució a laula 8.3 Comentari Deure 3 Veure aparatat deures: 11. "],["seminaris-setmana-4-2021-02-3.html", "Capítol 9 Seminaris Setmana 4 (2021-02-3) 9.1 Correcció Deure 3 9.2 Comentari Deure 4 9.3 Projectes en grup", " Capítol 9 Seminaris Setmana 4 (2021-02-3) 9.1 Correcció Deure 3 9.2 Comentari Deure 4 Veure aparatat deures: 11. 9.3 Projectes en grup tutories per grups. "],["seminaris-setmana-5-2021-02-10.html", "Capítol 10 Seminaris Setmana 5 (2021-02-10) 10.1 Correcció Deure 4 10.2 Comentari Deure 5 10.3 Projectes en grup", " Capítol 10 Seminaris Setmana 5 (2021-02-10) 10.1 Correcció Deure 4 10.2 Comentari Deure 5 Veure aparatat deures: 11. 10.3 Projectes en grup tutories per grups. "],["homework.html", "Capítol 11 Llista de Deures 11.1 Deure 1 11.2 Deure 2 11.3 Deure 3 11.4 Deure 4 11.5 Deure 5", " Capítol 11 Llista de Deures 11.1 Deure 1 NOTA: Descarrega la plantilla de solució deure 1 en Rmd. En el link https://griu.github.io/meacp_2021/data/dataXY.dat hi han les dues variables ESPVIDA i CALORIES del fitxer PAISOS.SAV (són lesperança de vida y les calories per habitant en diferents paisos del mon). Feu: Utiliza el program (Excel, SPSS o R) que coneguis. La lectura de les dades amb R seria dataXY&lt;-read.table(&#39;https://raw.githubusercontent.com/griu/griu.github.io/main/meacp_2021/data/dataXY.dat&#39;, header=TRUE, dec=&quot;,&quot;, sep=&quot;;&quot;) Una descripció breu univariant de cada una de les variables; summary(dataXY) ## CALORIES ESPVIDA ## Min. :1505 Min. :39.00 ## 1st Qu.:2248 1st Qu.:55.77 ## Median :2614 Median :67.55 ## Mean :2661 Mean :64.57 ## 3rd Qu.:3166 3rd Qu.:72.88 ## Max. :3947 Max. :79.50 Un diagrama de dispersió de ESPVIDA vs CALORIES. Comenta si sobserva o no associació entre aquests dues variables. library(ggplot2) ggplot(dataXY, aes(x=CALORIES, y=ESPVIDA)) + geom_point() Comenta si la associació observada justifica o no parlar de causalitat. 11.2 Deure 2 Considera les dades a PAISOS.SAV, lectura de dades en R: library(foreign) data &lt;- read.spss(&quot;https://griu.github.io/meacp_2021/data/PAISOS.SAV&quot;, use.value.labels = TRUE, to.data.frame = TRUE, use.missings =TRUE) Quins són els països que tenen menys de 47 anys desperança de vida? Quants països tenen menys dun terç de la seva població alfabetitzada? I daquests, quants tenen un PIB per càpita superior a 1.000 dòlars? Quina és la mitjana del nombre de diaris que es llegeixen al món? Hi ha diferències en la lectura de diaris segons nivell de desenvolupament humà? Creus que a Espanya sen llegeixen pocs? perquè? Quina és la mitjana dhabitants per metge? Quin és el valor daquesta mitjana en cada un dels tres nivells de desenvolupament humà en què shan classificat els països? Hi ha diferències significatives entre elles? En relació al fitxer de dades PAISOS.SAV, tria una variable Y del teu interès i descriu la variació de la mateixa emprant un altre variable del fitxer de dades. En aquest procés, ajusta un model de regressió lineal simple entre la variable depenent i la variable explicativa, descriu els resultats de la regressió lineal simple, i comprova que la hipòtesi de linealitat es plausible en aquestes dades. Si veus que la linealitat no es plausible, efectua la corresponent transformació prèvia de les variables. Recull els residus, I fes un gràfic dels residus vs. la variable depenent ajustada. Fes un breu resum de les conclusions que creus que es desprenen de la teva anàlisi. Explica també les limitacions de lanàlisi. 11.3 Deure 3 En relació a les dades de PAISOS.SAV. Investiga la variació de ESPVIDA en funció de CALORIES, controlant o no per altres variables explicatives. Inspecciona els residus de la regressió. Fes un breu resum de les conclusions que creus que es desprenen de la dependencia de ESPVIDA i CALORIES. 11.4 Deure 4 Considera les dades bank.sav (veure els fitxers de dades que hi ha a la web de lassignatura) de salaris de treballadors del sector de banca. Imagina que hi ha un plet en aquesta empresa sobre discriminació per raó de gènere. De fet, el salari actual dels homes és molt superior al de les dones. Fes les anàlisis de regressió simple i múltiple, amb les interpretacions i arguments corresponents, que aporten evidència empírica en defensa de lassociació que ha iniciat el plet contra lempresa. Dades: library(foreign) d &lt;- read.spss(http://84.89.132.1/~satorra/dades/bank2.sav, to.data.frame=TRUE) names(d) Inicialment fes un breu descriptiu (freqüències, mitjanes,) de les variables del fitxer segons siguin categòriques o contínues. Visualitza un scatterplot (gràfic de dispersió) de cadascuna de les variables contínues respecte a la variable del salari actual. Comenta la linealitat o no, de les relacions observades. Calcula la correlació de Pearson de cadascuna de les variables contínues i la variable salari actual. Transforma la variable Sexo a una variable numèrica. Utilitza una regressió lineal simple per tal de verificar que efectivament hi ha diferències salarials entre homes i dones. Explora ara diferents models lineals múltiples usant com a variable depenent Salari Actual i com a regressors del model la variable sexe i altres factors de control (Nivell educatiu, Mesos des del contracte, experiència prèvia,) . Un cop escollit el model anota quins son els coeficients del model, el seu nivell de significació, quin nivell dajust ha obtingut el model, això com lhistograma dels residus i el gràfics de dispersió dels valors ajustats sobre els residus. Comenta breument els diferents resultats Incorpora en el model la variable categòrica Categoria laboral i reporta els mateixos elements que en el punt anterior. Escriu quines son les conclusions principals que sextreuen del model pel que fa a la qüestió de la discriminació del salari. 11.5 Deure 5 Deure: Regressio Logistica Considera les dades de lenquesta postelectoral del CIS corresponent a les eleccions generals de 1986, fitxer CIS1542.SAV: library(foreign) d&lt;-read.spss(&quot;http://84.89.132.1/~satorra/dades/cis1542.sav&quot;, to.data.frame=TRUE) names(d) La variable dependent que vols explicar és ABST86, una variable dicotòmica. Considera com a variables explicatives les següents: MIDA_HAB, SEXE, EDAT, CASAT, ATURAT. Les dues últimes variables són categòriques. Considera la recodificació següent: CASAT, amb valor 1 si EST_CIV=2 i 0 en els altres casos ATURAT, amb valor 1 si SIT_LAB=2 i 0 en els altres casos Estima un model de regressió logística per tal dexplicar labstenció en funció daquestes 5 variables sociològiques. Treballa els següents punts: Quines de les variables incloses en el model són significatives (al 5% de significació)? Escriu la equació estimada que relaciona el logit de la probabilitat dabstenir-se amb les variables explicatives. És lineal aquesta equació? Escriu la equació estimada que relaciona la probabilitat dabstenir-se amb les variables explicatives. És lineal aquesta equació ? Segons el model estimat, quina probabilitat té dabstenir-se una noia soltera, que viu en una població de 60.000 habitants, que té 27 anys, que te una feina. Al mateix per una amiga seva, amb les mateixes característiques, però que està casada i ha perdut la seva feina. Considera ara les dones casades i que viuen en una població de 60.000 habitants. Calcula el grafic defectes sobre la probabilitat abstenció, de la varible Edat condicionat a si esta o no aturat (pots usar, si vols la funció visreg() vista a classe). El mateix que 5. pero pel grup dhomes. Comenta les principals diferencies o semblances entre els 2 gràfics anteriors. "]]
